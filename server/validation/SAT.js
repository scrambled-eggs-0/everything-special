import shared from '../../shared/shared.js';
!function(t,o){"use strict";"function"==typeof define&&define.amd?define(o):"object"==typeof exports?shared.SAT=o():shared.SAT=o()}(this,function(){"use strict";var t={};function a(t,o){this.x=t||0,this.y=o||0}function o(t,o){this.pos=t||new a,this.r=o||0,this.offset=new a}function r(t,o){this.pos=t||new a,this.angle=0,this.offset=new a,this.setPoints(o||[])}function h(t,o,e){this.pos=t||new a,this.w=o||0,this.h=e||0}function e(){this.a=null,this.b=null,this.overlapN=new a,this.overlapV=new a,this.clear()}t.Vector=a,(t.V=a).prototype.copy=a.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},a.prototype.clone=a.prototype.clone=function(){return new a(this.x,this.y)},a.prototype.perp=a.prototype.perp=function(){var t=this.x;return this.x=this.y,this.y=-t,this},a.prototype.rotate=a.prototype.rotate=function(t){var o=this.x,e=this.y;return this.x=o*Math.cos(t)-e*Math.sin(t),this.y=o*Math.sin(t)+e*Math.cos(t),this},a.prototype.reverse=a.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},a.prototype.normalize=a.prototype.normalize=function(){var t=this.len();return 0<t&&(this.x=this.x/t,this.y=this.y/t),this},a.prototype.add=a.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},a.prototype.sub=a.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},a.prototype.scale=a.prototype.scale=function(t,o){return this.x*=t,this.y*=void 0!==o?o:t,this},a.prototype.project=a.prototype.project=function(t){var o=this.dot(t)/t.len2();return this.x=o*t.x,this.y=o*t.y,this},a.prototype.projectN=a.prototype.projectN=function(t){var o=this.dot(t);return this.x=o*t.x,this.y=o*t.y,this},a.prototype.reflect=a.prototype.reflect=function(t){var o=this.x,e=this.y;return this.project(t).scale(2),this.x-=o,this.y-=e,this},a.prototype.reflectN=a.prototype.reflectN=function(t){var o=this.x,e=this.y;return this.projectN(t).scale(2),this.x-=o,this.y-=e,this},a.prototype.dot=a.prototype.dot=function(t){return this.x*t.x+this.y*t.y},a.prototype.len2=a.prototype.len2=function(){return this.dot(this)},a.prototype.len=a.prototype.len=function(){return Math.sqrt(this.len2())},(t.Circle=o).prototype.getAABBAsBox=o.prototype.getAABBAsBox=function(){var t=this.r;return new h(this.pos.clone().add(this.offset).sub(new a(t,t)),2*t,2*t)},o.prototype.getAABB=o.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},o.prototype.setOffset=o.prototype.setOffset=function(t){return this.offset=t,this},(t.Polygon=r).prototype.setPoints=r.prototype.setPoints=function(t){if(!this.points||this.points.length!==t.length)for(var o=this.calcPoints=[],e=this.edges=[],r=this.normals=[],s=0;s<t.length;s++){var n=t[s],p=s<t.length-1?t[s+1]:t[0];n===p||n.x!==p.x||n.y!==p.y?(o.push(new a),e.push(new a),r.push(new a)):(t.splice(s,1),--s)}return this.points=t,this._recalc(),this},r.prototype.setAngle=r.prototype.setAngle=function(t){return this.angle=t,this._recalc(),this},r.prototype.setOffset=r.prototype.setOffset=function(t){return this.offset=t,this._recalc(),this},r.prototype.rotate=r.prototype.rotate=function(t){for(var o=this.points,e=o.length,r=0;r<e;r++)o[r].rotate(t);return this._recalc(),this},r.prototype.translate=r.prototype.translate=function(t,o){for(var e=this.points,r=e.length,s=0;s<r;s++)e[s].x+=t,e[s].y+=o;return this._recalc(),this},r.prototype._recalc=function(){for(var t=this.calcPoints,o=this.edges,e=this.normals,r=this.points,s=this.offset,n=this.angle,p=r.length,i=0;i<p;i++){var h=t[i].copy(r[i]);h.x+=s.x,h.y+=s.y,0!==n&&h.rotate(n)}for(i=0;i<p;i++){var a=t[i],u=i<p-1?t[i+1]:t[0],a=o[i].copy(u).sub(a);e[i].copy(a).perp().normalize()}return this},r.prototype.getAABBAsBox=r.prototype.getAABBAsBox=function(){for(var t=this.calcPoints,o=t.length,e=t[0].x,r=t[0].y,s=t[0].x,n=t[0].y,p=1;p<o;p++){var i=t[p];i.x<e?e=i.x:i.x>s&&(s=i.x),i.y<r?r=i.y:i.y>n&&(n=i.y)}return new h(this.pos.clone().add(new a(e,r)),s-e,n-r)},r.prototype.getAABB=r.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},r.prototype.getCentroid=r.prototype.getCentroid=function(){for(var t=this.calcPoints,o=t.length,e=0,r=0,s=0,n=0;n<o;n++){var p=t[n],i=n===o-1?t[0]:t[n+1],h=p.x*i.y-i.x*p.y;e+=(p.x+i.x)*h,r+=(p.y+i.y)*h,s+=h}return new a(e/=s*=3,r/=s)},(t.Box=h).prototype.toPolygon=h.prototype.toPolygon=function(){var t=this.pos,o=this.w,e=this.h;return new r(new a(t.x,t.y),[new a,new a(o,0),new a(o,e),new a(0,e)])},(t.Response=e).prototype.clear=e.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var g=[],s=0;s<10;s++)g.push(new a);for(var u=[],s=0;s<5;s++)u.push([]);var n=new e,p=new h(new a,1e-6,1e-6).toPolygon();function y(t,o,e){for(var r=Number.MAX_VALUE,s=-Number.MAX_VALUE,n=t.length,p=0;p<n;p++){var i=t[p].dot(o);i<r&&(r=i),s<i&&(s=i)}e[0]=r,e[1]=s}function c(t,o,e,r,s,n){var p,i,h=u.pop(),a=u.pop(),o=g.pop().copy(o).sub(t),t=o.dot(s);return y(e,s,h),y(r,s,a),a[0]+=t,a[1]+=t,h[0]>a[1]||a[0]>h[1]?(g.push(o),u.push(h),u.push(a),!0):(n&&(h[t=0]<a[0]?(n.aInB=!1,h[1]<a[1]?(t=h[1]-a[0],n.bInA=!1):t=(p=h[1]-a[0])<(i=a[1]-h[0])?p:-i):(n.bInA=!1,h[1]>a[1]?(t=h[0]-a[1],n.aInB=!1):t=(p=h[1]-a[0])<(i=a[1]-h[0])?p:-i),(i=Math.abs(t))<n.overlap&&(n.overlap=i,n.overlapN.copy(s),t<0&&n.overlapN.reverse())),g.push(o),u.push(h),u.push(a),!1)}function A(t,o){var e=t.len2(),t=o.dot(t);return t<0?b:e<t?B:i}t.isSeparatingAxis=c;var b=-1,i=0,B=1;function l(t,o,e){for(var r=g.pop().copy(o.pos).add(o.offset).sub(t.pos),s=o.r,n=s*s,p=t.calcPoints,i=p.length,h=g.pop(),a=g.pop(),u=0;u<i;u++){var y=u===i-1?0:u+1,c=0===u?i-1:u-1,l=0,f=null;if(h.copy(t.edges[u]),a.copy(r).sub(p[u]),e&&a.len2()>n&&(e.aInB=!1),(x=A(h,a))===b){h.copy(t.edges[c]);c=g.pop().copy(r).sub(p[c]);if((x=A(h,c))===B){if(s<(v=a.len()))return g.push(r),g.push(h),g.push(a),g.push(c),!1;e&&(e.bInA=!1,f=a.normalize(),l=s-v)}g.push(c)}else if(x===B){if(h.copy(t.edges[y]),a.copy(r).sub(p[y]),(x=A(h,a))===b){if(s<(v=a.len()))return g.push(r),g.push(h),g.push(a),!1;e&&(e.bInA=!1,f=a.normalize(),l=s-v)}}else{var y=h.perp().normalize(),v=a.dot(y),x=Math.abs(v);if(0<v&&s<x)return g.push(r),g.push(y),g.push(a),!1;e&&(f=y,l=s-v,(0<=v||l<2*s)&&(e.bInA=!1))}f&&e&&Math.abs(l)<Math.abs(e.overlap)&&(e.overlap=l,e.overlapN.copy(f))}return e&&(e.a=t,e.b=o,e.overlapV.copy(e.overlapN).scale(e.overlap)),g.push(r),g.push(h),g.push(a),!0}function f(t,o,e){for(var r=t.calcPoints,s=r.length,n=o.calcPoints,p=n.length,i=0;i<s;i++)if(c(t.pos,o.pos,r,n,t.normals[i],e))return!1;for(i=0;i<p;i++)if(c(t.pos,o.pos,r,n,o.normals[i],e))return!1;return e&&(e.a=t,e.b=o,e.overlapV.copy(e.overlapN).scale(e.overlap)),!0}return t.pointInCircle=function(t,o){var e=g.pop().copy(t).sub(o.pos).sub(o.offset),t=o.r*o.r,o=e.len2();return g.push(e),o<=t},t.pointInPolygon=function(t,o){return p.pos.copy(t),n.clear(),f(p,o,n)&&n.aInB},t.testCircleCircle=function(t,o,e){var r=g.pop().copy(o.pos).add(o.offset).sub(t.pos).sub(t.offset),s=t.r+o.r,n=s*s,p=r.len2();return n<p?(g.push(r),!1):(e&&(p=Math.sqrt(p),e.a=t,e.b=o,e.overlap=s-p,e.overlapN.copy(r.normalize()),e.overlapV.copy(r).scale(e.overlap),e.aInB=t.r<=o.r&&p<=o.r-t.r,e.bInA=o.r<=t.r&&p<=t.r-o.r),g.push(r),!0)},t.testPolygonCircle=l,t.testCirclePolygon=function(t,o,e){var r=l(o,t,e);return r&&e&&(o=e.a,t=e.aInB,e.overlapN.reverse(),e.overlapV.reverse(),e.a=e.b,e.b=o,e.aInB=e.bInA,e.bInA=t),r},t.testPolygonPolygon=f,t});