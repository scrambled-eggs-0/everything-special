(()=>{"use strict";var e,t,n={674:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(601),i=n.n(o),a=n(314),r=n.n(a)()(i());r.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap);"]),r.push([e.id,"* {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n}\n\nbody {\n    background-color: rgb(5,5,5);\n    font-size: 16px;\n    overflow: hidden;\n    font-family: 'Inter', sans-serif;\n}\n\n.hidden {\n    display: none !important;\n}\n\n/*for comparing to eX and gamefeel. Not permanent*/\ncanvas, .gui {\n    position: absolute;\n    left: 0;\n    top: 0;\n    /* filter: saturate(75%);  */\n}\n\n.text-layer {\n\tposition: absolute;\n\tleft: 0;\n\ttop: 0;\n\twidth: 1600px;\n\theight: 900px;\n\tfilter: none !important;\n\tbackground: transparent;\n\toverflow: hidden;\n}\n\n.chatDiv {\n    z-index: 100;\n}\n\n.chat {\n    position: absolute;\n    left: 0px;\n    top: 250px;\n    width: 374px;\n    height: 30px;\n    transform-origin: center center;\n    border: none;\n    outline: none;\n    color: white;\n    font-size: 1rem;\n    padding: 5px;\n    caret-color: white;\n    /*background: rgba(129, 129, 129, 0.082);*/\n    background: linear-gradient(to right, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0));\n    font-family: 'Inter-Thick', Inter;\n}\n\n.chat-message {\n    color: white;\n    font-size: 1.05rem;\n    background: transparent;\n    padding: 1px;\n\n    overflow-wrap: break-word;\n    width: 100%;\n}\n.system-message {\n    color: #c4c4c4;\n    font-size: 1rem;\n    background: transparent;\n    padding: 1px;\n    overflow-wrap: break-word; /*this doesnt work somehow*/\n    width: 100%;\n}\n\n.fade-out {\n    animation: fade-out 0.3s linear;\n}\n\n.fade-in {\n    animation: fade-in 0.3s linear;\n}\n\n@keyframes fade-out {\n    0% {\n        opacity: 1;\n    }\n    100% {\n        opacity: 0;\n    }\n}\n\n/*peaceful*/\n.difficulty-0 {\n    color: #6cd95b;\n}\n/*moderate*/\n.difficulty-1 {\n    color: #58ccb3;\n}\n/*difficult*/\n.difficulty-2 {\n    color: #0a77bf;\n}\n/*hardcore*/\n.difficulty-3 {\n    color: #3528e0;\n}\n/*exhausting*/\n.difficulty-4 {\n    color: #8248d4;\n}\n/*relentless*/\n.difficulty-5 {\n    color: #e32d8b;\n}\n/*agonizing*/\n@keyframes agonizingColor {\n    0% {\n        background-color: #ff0000;\n    }\n}\n.difficulty-6 {\n    color: #ff5736;\n    animation-name: agonizingColor;\n    animation-duration: 3s;\n    animation-iteration-count: infinite;\n}\n/*terrorizing*/\n@keyframes terrorizingColor {\n    0% {\n        background-color: #ff0000;\n    }\n}\n.difficulty-7 {\n    color: #fc3a3a;\n    animation-name: terrorizingColor;\n    animation-duration: 2s;\n    animation-iteration-count: infinite;\n}\n@keyframes cataclysmicColor {\n    0% {\n        background-color: #ff0000;\n    }\n}\n/*cataclysmic*/\n.difficulty-8 {\n    color: #c95d5d;\n    animation-name: cataclysmicColor;\n    animation-duration: 1s;\n    animation-iteration-count: infinite;\n}\n\n.mention {\n    /*color: #a84040;*/\n    background-image: linear-gradient(\n        90deg,\n        rgba(255, 0, 0, 0.3),\n        rgba(255, 0, 0, 0)\n    );\n    animation-name: terrorizingColor;\n    animation-duration: 0.4s;\n    animation-iteration-count: 1;\n}\n\n.chat::placeholder {\n    color: white;\n    opacity: 1;\n}\n\n.leaderboard-div {\n    position: fixed;\n    left: calc(100% - 299px);\n    transition: left 0.2s linear, opacity 0.2s linear;\n    opacity: 1;\n    top: -1px;\n    width: 300px;\n    height: 100vh;\n    background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.4));\n    display: flex;\n    justify-content: start;\n    align-items: center;\n    flex-direction: column;\n    padding: 0px;\n    color: white;\n    overflow-y: auto;\n    overflow-x: hidden;\n    user-select: none;\n    font-family: 'Inter-Thick', Inter;\n}\n\n.hide {\n    left: 1600px !important;\n    opacity: 0;\n}\n\n.leaderboard-div::-webkit-scrollbar {\n    width: 10px;\n    background-color: rgba(255, 255, 255, 0.1);\n    border-radius: 2px;\n}\n\n.leaderboard-div::-webkit-scrollbar-thumb {\n    background-color: rgba(255, 255, 255, 0.3);\n    border-radius: 2px;\n}\n\n.rainbow {\n    animation: colorRotate 4s linear 0s infinite;\n}\n\n@keyframes colorRotate {\n    0% {\n        color: hsl(180, 100%, 50%);\n    }\n    50% {\n        color: hsl(216, 100%, 50%);\n    }\n    100% {\n        color: hsl(180, 100%, 50%);\n    }\n}\n\n.guest {\n    opacity: 0.8;\n}\n\n.chat-div::-webkit-scrollbar {\n    width: 10px;\n    background-color: rgba(0, 0, 0, 0.4);\n}\n\n.chat-div::-webkit-scrollbar-thumb {\n    background-color: rgba(0, 0, 0, 0.8);\n}\n\n.chat-div {\n    position: absolute;\n    left: -1px;\n    top: -1px;\n    width: 375px;\n    height: 251px;\n    filter: none !important;\n    background: rgba(141, 141, 141, 0.205);\n    background: linear-gradient(to right, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0));\n    display: flex;\n    justify-content: flex-start;\n    align-items: flex-start;\n    flex-direction: column;\n    overflow-y: auto;\n    padding: 2px;\n    overflow-x: hidden;\n    /* \tword-break: break-all; */\n    font-family: Inter-Thick, Inter;\n\n    transition: all 0.1s linear, padding 0.1s linear;\n    /*\n    /*background-image: url(https://i1.sndcdn.com/artworks-Uii8SMJvNPxy8ePA-romBoQ-t500x500.jpg);*/\n    /*    opacity: 0.7; */\n}\n\n.lb-group {\n    /* background: rgba(255, 255, 255, 0.1); */\n    /*background: rgb(55, 55, 55);*/\n    background: transparent;\n    padding: 5px;\n    display: flex;\n    justify-content: start;\n    align-items: center;\n    flex-direction: column;\n    margin: 0px;\n    /*min-width: 150px;*/\n    width: 300px;\n}\n\n\n.lb-name {\n    /* color: rgb(47, 250, 213); */\n    /* filter: saturate(150%); */\n    font-size: 1rem;\n}\n\n.lb-players {\n    margin: 5px;\n    font-size: 0.9rem;\n    /* background: rgba(255, 255, 255, 0.12); */\n    /* background: rgba(77, 77, 77, 0.7); */\n    display: flex;\n    justify-content: start;\n    align-items: center;\n    flex-direction: column;\n}\n\n.lb-players div {\n    margin: 1.5px;\n\tcursor: pointer;\n\tbackground: transparent;\n\tpadding: 0px;\n\ttransition: all 0.1s linear, padding 0.1s linear;\n\twidth: 100%;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n.lb-players div:hover {\n\tbackground: rgba(255, 255, 255, 0.3);\n\tpadding: 6px;\n}\n\n.hideLB {\n    left: 100% !important;\n    opacity: 0;\n}\n\n.hideChat {\n    left: -175px !important;\n    opacity: 0; \n}",""]);const s=r},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,i,a){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(o)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(r[l]=!0)}for(var c=0;c<e.length;c++){var p=[].concat(e[c]);o&&r[p[0]]||(void 0!==a&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=a),n&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=n):p[2]=n),i&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=i):p[4]="".concat(i)),t.push(p))}},t}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var a={},r=[],s=0;s<e.length;s++){var l=e[s],c=o.base?l[0]+o.base:l[0],p=a[c]||0,d="".concat(c," ").concat(p);a[c]=p+1;var u=n(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)t[u].references++,t[u].updater(h);else{var f=i(h,o);o.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}r.push(d)}return r}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var a=o(e=e||[],i=i||{});return function(e){e=e||[];for(var r=0;r<a.length;r++){var s=n(a[r]);t[s].references--}for(var l=o(e,i),c=0;c<a.length;c++){var p=n(a[c]);0===t[p].references&&(t[p].updater(),t.splice(p,1))}a=l}}},659:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,i&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},982:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var o=n(763);let i,a=[],r=-1,s="",l=1/0,c=0;function p(){ctx.font=50+(r<0?0:20*u(r/30))+"px monospace",ctx.textAlign="middle",ctx.textBaseline="top",ctx.globalAlpha=.95;const e=(window.frames-o.A.mapEntryTime)/60;let t;"/maps/winroom"!==o.A.mapPath&&!0!==o.A.won||void 0===c?r>=0?(r--,t=d(s)):t=d(e):t=c,l<e&&(c=t),l=e,ctx.textAlign="center",ctx.textBaseline="top";const n=ctx.measureText(t),p=n.actualBoundingBoxRight+n.actualBoundingBoxLeft+60,h=n.actualBoundingBoxDescent+n.actualBoundingBoxAscent+50,f=(n.actualBoundingBoxDescent-n.actualBoundingBoxAscent)/2,g=o.A.colors.background,m=parseInt(g.slice(1),16),x=m>>16&255,y=m>>8&255,A=255&m;ctx.translate(canvas.w/2,15+h/2-f),ctx.scale(p/h,1);const v=ctx.createRadialGradient(0,0,0,0,0,h/2);if(v.addColorStop(0,`rgba(${x},${y},${A},0.5)`),v.addColorStop(1,`rgba(${x},${y},${A},0)`),ctx.fillStyle=v,ctx.beginPath(),ctx.arc(0,0,h/2,0,2*Math.PI),ctx.fill(),ctx.closePath(),ctx.scale(h/p,1),ctx.translate(-canvas.w/2,-(15+h/2-f)),ctx.fillStyle=r>0?r<3?o.A.blendColor("#ffff00","#ffffff",u(1-r/3)):"#ffff00":"white",ctx.fillText(t,canvas.w/2,15),i!==o.A.mapPath){i=o.A.mapPath,a.length=0;for(let e=0;e<o.A.obstacles.length;e++)void 0!==o.A.obstacles[e].checkpointOffsetX&&a.push(o.A.obstacles[e])}for(let t=0;t<a.length;t++)if(!0===a[t].checkpointCollected){a.splice(t,1),s=e,r=30;break}}const d=e=>{let t=(~~(100*e)%100).toString(),n=(~~(e%60)).toString();1===t.length&&(t="0"+t),1===n.length&&(n="0"+n);const o=(~~(e/60%60)).toString();let i=`${o}:${n}.${t}`;return e>3600&&(1===o.length&&(o="0"+o),i=`${(~~(e/3600)).toString()}:${o}:${n}.${t}`),i};function u(e){return e*e*e*(e*(6*e-15)+10)}},763:(e,t,n)=>{n.d(t,{A:()=>o});const o={}}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var a=o[e]={id:e,exports:{}};return n[e](a,a.exports,i),a.exports}i.m=n,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+".bundle.js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="omniserver:",i.l=(n,o,a,r)=>{if(e[n])e[n].push(o);else{var s,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),p=0;p<c.length;p++){var d=c[p];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+a){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+a),s.src=n),e[n]=[o];var u=(t,o)=>{s.onerror=s.onload=null,clearTimeout(h);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(o))),t)return t(o)},h=setTimeout(u.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=u.bind(null,s.onerror),s.onload=u.bind(null,s.onload),l&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={792:0};i.f.j=(t,n)=>{var o=i.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var a=new Promise(((n,i)=>o=e[t]=[n,i]));n.push(o[2]=a);var r=i.p+i.u(t),s=new Error;i.l(r,(n=>{if(i.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var a=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+r+")",s.name="ChunkLoadError",s.type=a,s.request=r,o[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var o,a,[r,s,l]=n,c=0;if(r.some((t=>0!==e[t]))){for(o in s)i.o(s,o)&&(i.m[o]=s[o]);l&&l(i)}for(t&&t(n);c<r.length;c++)a=r[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkomniserver=self.webpackChunkomniserver||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),i.nc=void 0;var a=i(72),r=i.n(a),s=i(825),l=i.n(s),c=i(659),p=i.n(c),d=i(56),u=i.n(d),h=i(540),f=i.n(h),g=i(113),m=i.n(g),x=i(674),y={};y.styleTagTransform=m(),y.setAttributes=u(),y.insert=p().bind(null,"head"),y.domAPI=l(),y.insertStyleElement=f(),r()(x.A,y),x.A&&x.A.locals&&x.A.locals;var A=i(763);i(982);let v=window.canvas=document.getElementById("canvas"),S=window.ctx=v.getContext("2d");const w=A.A.camera={x:0,y:0,scale:1,numControlledBy:0,angle:0,z:1,basis1:[1,0,0],basis2:[0,1,0],normal:[0,0,1]};A.A.defaultColors={tile:"#1f2229",background:"#323645",vignette:{inner:{size:.1,r:0,g:0,b:0,opacity:0},outer:{size:.6,r:0,g:0,b:0,opacity:1},innerInterp:{size:.1,r:0,g:0,b:0,opacity:0},outerInterp:{size:.6,r:0,g:0,b:0,opacity:1},holeFunctions:[]}},A.A.colors={tile:A.A.defaultColors.tile,background:A.A.defaultColors.background,vignette:{inner:{size:.1,r:0,g:0,b:0,opacity:0},outer:{size:.6,r:0,g:0,b:0,opacity:1},innerInterp:{size:.1,r:0,g:0,b:0,opacity:0},outerInterp:{size:.6,r:0,g:0,b:0,opacity:1},holeFunctions:[]}},A.A.selfId=void 0,A.A.tileSize=100,A.A.renderDebug=!1,A.A.distortionsActive=!1,A.A.skullImgLoaded=!1,A.A.skullImg=void 0,A.A.renderTimer=!1;let b,M,T,P,k,I,C,R,L=!1,F=!1,E=0,D=0,B=0,z=0,U=0,O=0,N=0;A.A.render=(e=A.A.obstacles,t=A.A.colors,n=A.A.players)=>{if(L=!1,void 0!==A.A.selfId){const e=n[A.A.selfId];0===w.numControlledBy&&(w.x=e.pos.x,w.y=e.pos.y,w.angle=0,!0===e.ship&&(w.angle=Math.PI/2+e.shipAngle,L=!0)),0!==w.angle&&(S.translate(v.w/2,v.h/2),S.rotate(-w.angle),S.translate(-v.w/2,-v.h/2))}if(!0===L){S.fillStyle=t.tile,N=(v.w+v.h)/2,S.fillRect(-N,-N,4*N,4*N),B=w.x-N,z=w.x+N,U=w.y-N,O=w.y+N,S.fillStyle=t.background,S.fillRect(1-(w.x-v.w/2),1-(w.y-v.h/2),A.A.mapDimensions.x-2,A.A.mapDimensions.y-2),S.globalAlpha=.75,S.lineWidth=4.8,S.strokeStyle=t.tile,C=Math.sqrt(v.w**2+v.h**2),I=C/2%A.A.tileSize-A.A.tileSize-C/2;for(let e=(v.w/2-w.x)%A.A.tileSize+I;e<C+S.lineWidth+A.A.tileSize;e+=A.A.tileSize)S.beginPath(),S.moveTo(e,I),S.lineTo(e,v.h-I),S.stroke(),S.closePath();for(let e=(v.h/2-w.y)%A.A.tileSize+I;e<C+S.lineWidth+A.A.tileSize;e+=A.A.tileSize)S.beginPath(),S.moveTo(I,e),S.lineTo(v.w-I,e),S.stroke(),S.closePath()}else{S.fillStyle=t.tile,S.fillRect(0,0,v.w,v.h),B=w.x-v.w/2,z=w.x+v.w/2,U=w.y-v.h/2,O=w.y+v.h/2,S.fillStyle=t.background,S.fillRect(1-(w.x-v.w/2),1-(w.y-v.h/2),A.A.mapDimensions.x-2,A.A.mapDimensions.y-2),S.globalAlpha=.75,S.lineWidth=4.8,S.strokeStyle=t.tile;for(let e=(v.w/2-w.x)%A.A.tileSize;e<v.w+S.lineWidth+A.A.tileSize;e+=A.A.tileSize)S.beginPath(),S.moveTo(e,0),S.lineTo(e,v.h),S.stroke(),S.closePath();for(let e=(v.h/2-w.y)%A.A.tileSize;e<v.h+S.lineWidth+A.A.tileSize;e+=A.A.tileSize)S.beginPath(),S.moveTo(0,e),S.lineTo(v.w,e),S.stroke(),S.closePath()}S.globalAlpha=1,S.translate(-(w.x-v.w/2),-(w.y-v.h/2)),X(e,t);for(let e=0;e<n.length;e++){const t=n[e];if(void 0!==t)if(void 0===t.cr){if(S.fillStyle=!0===t.dead?"red":"black",k=t.sat.r,t.sat.r=Math.abs(t.renderRadius),T=t.pos.x,P=t.pos.y,e!==A.A.selfId&&(t.pos.x=t.interpX,t.pos.y=t.interpY),S.beginPath(),t.renderShape(t),t.renderRadius>=0)S.fill();else{const e=2*Math.PI*Math.abs(!0===t.dead?t.sat.r:void 0),n=Math.max(3,Math.floor(e/42));E=.96*E+2/7*e/n*.04,D=.96*D+5/7*e/n*.04,S.setLineDash([E,D]),S.lineDashOffset=-A.A.frames/1.56%e,S.strokeStyle=S.fillStyle,S.lineWidth=8,S.lineCap="round",S.stroke(),S.setLineDash([])}!0===t.god&&(S.strokeStyle="purple",S.lineWidth=10,S.stroke()),!0===t.ship&&(S.strokeStyle="#0033ed",S.lineWidth=10,S.lineCap="round",S.moveTo(t.pos.x,t.pos.y),S.lineTo(t.pos.x+Math.cos(t.shipAngle)*t.sat.r,t.pos.y+Math.sin(t.shipAngle)*t.sat.r),S.stroke()),!0===t.grapple&&(S.beginPath(),S.strokeStyle="#969696",S.globalAlpha=.75,S.lineWidth=12,S.arc(t.pos.x,t.pos.y,Math.abs(t.renderRadius)/2,0,2*Math.PI),-1===t.grappleX&&t.id===A.A.selfId&&!0===A.A.input.action1?(S.strokeStyle="white",S.stroke(),S.closePath(),S.beginPath(),S.globalAlpha=.2,S.arc(t.pos.x,t.pos.y,t.grappleRange,0,2*Math.PI),S.stroke(),S.closePath()):-1!==t.grappleX?(S.strokeStyle="white",S.stroke(),S.closePath(),S.beginPath(),S.moveTo(t.pos.x,t.pos.y),S.lineTo(t.grappleX,t.grappleY),S.stroke(),S.closePath(),S.lineWidth=10,S.beginPath(),S.arc(t.grappleX,t.grappleY,10,0,2*Math.PI),S.stroke(),S.closePath()):(S.stroke(),S.closePath()),S.globalAlpha=1),!0===t.deathTimer&&(S.fillStyle="red",S.font="60px Inter",S.textAlign="center",S.textBaseline="middle",S.shadowBlur=2,S.shadowColor="red",S.fillText(~~(t.deathTime/60),t.pos.x,t.pos.y),S.shadowBlur=0),S.closePath(),S.fillStyle="white",S.font=(Math.abs(t.renderRadius)+.5)/25*15+"px Inter",S.textAlign="center",S.textBaseline="middle",S.fillText(t.name,t.pos.x,t.pos.y+4*t.renderRadius/3+3),t.pos.x=T,t.pos.y=P,t.sat.r=k}else t.cr(t)}if(!0===A.A.renderDebug){S.fillStyle="red",S.strokeStyle="red",S.lineWidth=2;for(let t=0;t<e.length;t++)e[t].topLeft.x>z||e[t].topLeft.x+e[t].dimensions.x<B||e[t].topLeft.y>O||e[t].topLeft.y+e[t].dimensions.y<U||(S.beginPath(),S.arc(e[t].pos.x,e[t].pos.y,10,0,2*Math.PI),S.fill(),S.closePath(),S.strokeRect(e[t].topLeft.x,e[t].topLeft.y,e[t].dimensions.x,e[t].dimensions.y));S.fillStyle="white",S.textAlign="center",S.textBaseline="middle";for(let e=0;e<n.length;e++){const t=n[e];void 0!==t&&(S.font=(Math.abs(t.renderRadius)+.5)/25*18+"px Inter",S.fillText(`(${50*Math.round(t.pos.x/50)},${50*Math.round(t.pos.y/50)})`,t.pos.x,t.pos.y-4*t.renderRadius/3-4.5))}}S.translate(w.x-v.w/2,w.y-v.h/2),0!==w.angle&&(S.translate(v.w/2,v.h/2),S.rotate(w.angle),S.translate(-v.w/2,-v.h/2));const o=A.A.colors.vignette;S.beginPath();const i=S.createRadialGradient(v.w/2,v.h/2,Math.max(v.w,v.h)*o.innerInterp.size,v.w/2,v.h/2,Math.max(v.w,v.h)*o.outerInterp.size);if(i.addColorStop(0,`rgba(${o.innerInterp.r},${o.innerInterp.g},${o.innerInterp.b},${o.innerInterp.opacity})`),i.addColorStop(1,`rgba(${o.outerInterp.r},${o.outerInterp.g},${o.outerInterp.b},${o.outerInterp.opacity})`),S.fillStyle=i,S.rect(0,0,v.w,v.h),0!==o.holeFunctions.length){if(void 0!==A.A.selfId){const e=n[A.A.selfId];!0===e.ship&&(S.translate(v.w/2,v.h/2),S.rotate(-e.shipAngle-Math.PI/2),S.translate(-v.w/2,-v.h/2))}S.translate(v.w/2-w.x,v.h/2-w.y);for(let e=0;e<o.holeFunctions.length;e++)o.holeFunctions[e]();if(S.translate(w.x-v.w/2,w.y-v.h/2),void 0!==A.A.selfId){const e=n[A.A.selfId];!0===e.ship&&(S.translate(v.w/2,v.h/2),S.rotate(e.shipAngle+Math.PI/2),S.translate(-v.w/2,-v.h/2))}}if(S.fill("evenodd"),S.closePath(),A.A.colors.vignette.inner={size:.1,r:0,g:0,b:0,opacity:0},A.A.colors.vignette.outer={size:.6,r:0,g:0,b:0,opacity:1},A.A.colors.vignette.holeFunctions.length=0,!0===A.A.disconnected){let e="Disconnected From Server.".split("");for(let t=0;t<e.length;t++)Math.random()<.03&&(e[t]="#");e=e.join(""),S.font="81px Inter",S.fillStyle="#00ff41",S.textAlign="right",S.textBaseline="bottom",S.fillText(e,v.w-30,v.h-50),S.font="28px Inter",S.fillText("You may still play the current map but cannot win or leave.",v.w-30,v.h-18)}else!0===A.A.renderTimer&&q();!0===A.A.distortionsActive&&A.A.renderGl()},A.A.disableCulling=()=>{B=U=-1/0,z=O=1/0};const X=A.A.renderObstacles=(e,t=A.A.colors)=>{for(let n=0;n<e.length;n++)void 0===e[n].cr?e[n].topLeft.x>z||e[n].topLeft.x+e[n].dimensions.x<B||e[n].topLeft.y>O||e[n].topLeft.y+e[n].dimensions.y<U||(M=e[n].effect.length,1===M?(F=0,S.toFill=!0,S.toStroke=!1,S.lineWidth=4,S.beginPath(),e[n].renderShape(e[n]),e[n].renderEffect[F](e[n]),!0===e[n].isText&&Y(e[n],t),!0===S.toFill&&S.fill(),!0===S.toStroke&&S.stroke(),void 0!==S.cleanUpFunction&&(S.cleanUpFunction(),S.cleanUpFunction=void 0),S.closePath(),S.globalAlpha=1):(e[n].renderEffectTimer+=1/128,e[n].renderEffectTimer>=M&&(e[n].renderEffectTimer-=M),b=Math.floor(e[n].renderEffectTimer),F=b-1,-1===F&&(F=M-1),S.toFill=!0,S.toStroke=!1,S.lineWidth=2,S.beginPath(),e[n].renderShape(e[n]),e[n].renderEffect[F](e[n]),!0===e[n].isText&&Y(e[n],t),S.globalAlpha=1,!0===S.toFill&&S.fill(),!0===S.toStroke&&S.stroke(),void 0!==S.cleanUpFunction&&(S.cleanUpFunction(),S.cleanUpFunction=void 0),S.closePath(),F=b,S.toFill=!0,S.toStroke=!1,S.lineWidth=2,S.beginPath(),e[n].renderShape(e[n]),e[n].renderEffect[F](e[n]),!0===e[n].isText&&Y(e[n],t),S.globalAlpha=e[n].renderEffectTimer-b,!0===S.toFill&&S.fill(),!0===S.toStroke&&S.stroke(),void 0!==S.cleanUpFunction&&(S.cleanUpFunction(),S.cleanUpFunction=void 0),S.closePath(),S.globalAlpha=1)):e[n].cr(e[n])};function Y(e,t){R=S.globalAlpha,S.textAlign="center",S.textBaseline="middle",S.font=`${e.fontSize}px Inter`,S.translate(e.topLeft.x+e.dimensions.x/2,e.topLeft.y+e.dimensions.y/2),void 0!==e.rotation&&S.rotate(e.rotation),S.globalAlpha<.5&&(S.globalAlpha=.5),!0===S.toFill&&S.fillText(e.text,0,0),!0===S.toStroke?S.strokeText(e.text,0,0):!1===S.toFill&&(S.globalAlpha=1,S.fillStyle=t.tile,S.fillText(e.text,0,0)),void 0!==e.rotation&&S.rotate(-e.rotation),S.translate(-e.topLeft.x-e.dimensions.x/2,-e.topLeft.y-e.dimensions.y/2),S.globalAlpha=Math.min(.5,R)}A.A.resizeFns=[];const V=document.querySelector(".gui")??{style:{}};let j,_,W,$,G=1;void 0===A.A.isEditor&&(A.A.isEditor=!1),A.A.resize=()=>{if(!0===A.A.isEditor){const e=A.A.left.getBoundingClientRect();j=e.width,_=e.height}else j=window.innerWidth,_=window.innerHeight;G=A.A.camera.scale,A.A.changeCameraScale(1);const e=window.devicePixelRatio;V.style.width=v.style.width=Math.ceil(j)+"px",V.style.height=v.style.height=Math.ceil(_)+"px",V.width=v.width=Math.ceil(j)*e,V.height=v.height=Math.ceil(_)*e,v.zoom=Math.max(.1,Math.round(Math.max(v.height,.5625*v.width)/1800*w.scale*100)/100),v.w=v.width/v.zoom,v.h=v.height/v.zoom,S.scale(v.zoom,v.zoom),S.lineJoin="round",S.lineCap="round";for(let e=0;e<A.A.resizeFns.length;e++)A.A.resizeFns[e]();A.A.changeCameraScale(G)},A.A.changeCameraScale=e=>{S.translate(-(1-1/A.A.camera.scale)*v.w/2,-(1-1/A.A.camera.scale)*v.h/2),S.translate(v.w/2,v.h/2),S.scale(1/A.A.camera.scale,1/A.A.camera.scale),S.translate(-v.w/2,-v.h/2),A.A.camera.scale=e,v.w=v.width/v.zoom/A.A.camera.scale,v.h=v.height/v.zoom/A.A.camera.scale,S.translate(v.w/2,v.h/2),S.scale(A.A.camera.scale,A.A.camera.scale),S.translate(-v.w/2,-v.h/2),S.translate((1-1/A.A.camera.scale)*v.w/2,(1-1/A.A.camera.scale)*v.h/2)},window.addEventListener("resize",(function(){A.A.resize()})),A.A.resize(),A.A.initDistortion=async(e,t,n=[],o=[])=>{void 0===W&&(W=(await i.e(964).then(i.bind(i,964))).default),W.initNonlinearTransform(e,t,n,o)},A.A.unInitDistortion=()=>{void 0!==W&&W.unInitNonlinearTransform()},A.A.importNoise=async()=>void 0!==$?$:$=(await i.e(417).then(i.bind(i,417))).default;let q,J=!1;var K,H;A.A.importYoutube=async()=>{if(!0===J)return;const e=i.e(494).then(i.bind(i,494)),t=new Promise((e=>{const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",document.body.appendChild(t),window.onYouTubeIframeAPIReady=()=>{e()}}));return J=!0,Promise.all([e,t])},A.A.toggleTimer=async()=>{!0!==A.A.renderTimer?void 0===q?(q=(await Promise.resolve().then(i.bind(i,982))).default,A.A.renderTimer=!0):A.A.renderTimer=!0:A.A.renderTimer=!1},A.A.unTaintCanvas=()=>{const e=S.getTransform(),t=document.createElement("canvas");document.body.insertBefore(t,v),v.remove(),v=window.canvas=t,v.id="canvas",S=window.ctx=v.getContext("2d"),A.A.resize(),S.setTransform(e)},A.A.translateScreenToWorld=()=>{S.translate(-(w.x-v.w/2),-(w.y-v.h/2))},A.A.translateWorldToScreen=()=>{S.translate(w.x-v.w/2,w.y-v.h/2)},A.A.screenToWorld=(e,t)=>[e+(w.x-v.w/2),t+(w.y-v.h/2)],A.A.worldToScreen=(e,t)=>[e-(w.x-v.w/2),t-(w.y-v.h/2)],A.A.render,K=void 0,H=function(e){try{t=new TextDecoder}catch(e){}var t,n,o,i,a,r,s,l,c=0,p={},d=0,u=0,h=[],f={useRecords:!1,mapsAsObjects:!0};class g{}let m=new g;m.name="MessagePack 0xC1";var x=!1,y=2;try{Function("")}catch(e){y=1/0}class A{constructor(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),!e.sequential||!1===e.trusted||(e.trusted=!0,e.structures||0==e.useRecords||(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(n)return G((()=>(q(),this?this.unpack(e,t):A.prototype.unpack.call(f,e,t))));e.buffer||e.constructor!==ArrayBuffer||(e="undefined"!=typeof Buffer?Buffer.from(e):new Uint8Array(e)),"object"==typeof t?(o=t.end||e.length,c=t.start||0):(c=0,o=t>-1?t:e.length),u=0,a=null,r=null,n=e;try{l=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(t){if(n=null,e instanceof Uint8Array)throw t;throw Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}return this instanceof A?(p=this,this.structures?i=this.structures:(!i||i.length>0)&&(i=[])):(p=f,(!i||i.length>0)&&(i=[])),v()}unpackMultiple(e,t){let n,o=0;try{x=!0;let i=e.length,a=this?this.unpack(e,i):K.unpack(e,i);if(!t){for(n=[a];c<i;)o=c,n.push(v());return n}if(!1===t(a,o,c))return;for(;c<i;)if(o=c,!1===t(v(),o,c))return}catch(e){throw e.lastPosition=o,e.values=n,e}finally{x=!1,q()}}_mergeStructures(e,t){Object.isFrozen(e=e||[])&&(e=e.map((e=>e.slice(0))));for(let t=0,n=e.length;t<n;t++){let n=e[t];n&&(n.isShared=!0,t>=32&&(n.highByte=t-32>>5))}for(let n in e.sharedLength=e.length,t||[])if(n>=0){let o=e[n],i=t[n];i&&(o&&((e.restoreStructures||(e.restoreStructures=[]))[n]=o),e[n]=i)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function v(e){try{if(!p.trusted&&!x){let e=i.sharedLength||0;e<i.length&&(i.length=e)}let e;if(p.randomAccessStructure&&n[c]<64&&n[c],e=w(),r&&(c=r.postBundlePosition,r=null),x&&(i.restoreStructures=null),c==o)i&&i.restoreStructures&&S(),i=null,n=null,s&&(s=null);else{if(c>o)throw Error("Unexpected end of MessagePack data");if(!x){let t;try{t=JSON.stringify(e,((e,t)=>"bigint"==typeof t?`${t}n`:t)).slice(0,100)}catch(e){t="(JSON view not available "+e+")"}throw Error("Data read, but end of buffer not reached "+t)}}return e}catch(e){throw i&&i.restoreStructures&&S(),q(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||c>o)&&(e.incomplete=!0),e}}function S(){for(let e in i.restoreStructures)i[e]=i.restoreStructures[e];i.restoreStructures=null}function w(){let e=n[c++];if(e<160){if(e<128){if(e<64)return e;{let t=i[63&e]||p.getStructures&&P()[63&e];return t?(t.read||(t.read=M(t,63&e)),t.read()):e}}if(e<144){if(e-=128,p.mapsAsObjects){let t={};for(let n=0;n<e;n++){let e=Y();"__proto__"===e&&(e="__proto_"),t[e]=w()}return t}{let t=new Map;for(let n=0;n<e;n++)t.set(w(),w());return t}}{let t=Array(e-=144);for(let n=0;n<e;n++)t[n]=w();return p.freezeData?Object.freeze(t):t}}if(e<192){let t=e-160;if(u>=c)return a.slice(c-d,(c+=t)-d);if(0==u&&o<140){let e=t<16?z(t):B(t);if(null!=e)return e}return k(t)}{let t;switch(e){case 192:return null;case 193:return r?(t=w())>0?r[1].slice(r.position1,r.position1+=t):r[0].slice(r.position0,r.position0-=t):m;case 194:return!1;case 195:return!0;case 196:if(void 0===(t=n[c++]))throw Error("Unexpected end of buffer");return O(t);case 197:return t=l.getUint16(c),c+=2,O(t);case 198:return t=l.getUint32(c),c+=4,O(t);case 199:return N(n[c++]);case 200:return t=l.getUint16(c),c+=2,N(t);case 201:return t=l.getUint32(c),c+=4,N(t);case 202:if(t=l.getFloat32(c),p.useFloat32>2){let e=J[(127&n[c])<<1|n[c+1]>>7];return c+=4,(e*t+(t>0?.5:-.5)|0)/e}return c+=4,t;case 203:return t=l.getFloat64(c),c+=8,t;case 204:return n[c++];case 205:return t=l.getUint16(c),c+=2,t;case 206:return t=l.getUint32(c),c+=4,t;case 207:return"number"===p.int64AsType?(t=4294967296*l.getUint32(c),t+=l.getUint32(c+4)):"string"===p.int64AsType?t=l.getBigUint64(c).toString():"auto"===p.int64AsType?(t=l.getBigUint64(c))<=BigInt(2)<<BigInt(52)&&(t=Number(t)):t=l.getBigUint64(c),c+=8,t;case 208:return l.getInt8(c++);case 209:return t=l.getInt16(c),c+=2,t;case 210:return t=l.getInt32(c),c+=4,t;case 211:return"number"===p.int64AsType?(t=4294967296*l.getInt32(c),t+=l.getUint32(c+4)):"string"===p.int64AsType?t=l.getBigInt64(c).toString():"auto"===p.int64AsType?(t=l.getBigInt64(c))>=BigInt(-2)<<BigInt(52)&&t<=BigInt(2)<<BigInt(52)&&(t=Number(t)):t=l.getBigInt64(c),c+=8,t;case 212:if(114==(t=n[c++]))return V(63&n[c++]);{let e=h[t];if(e)return e.read?(c++,e.read(w())):e.noBuffer?(c++,e()):e(n.subarray(c,++c));throw Error("Unknown extension "+t)}case 213:return 114==(t=n[c])?(c++,V(63&n[c++],n[c++])):N(2);case 214:return N(4);case 215:return N(8);case 216:return N(16);case 217:return t=n[c++],u>=c?a.slice(c-d,(c+=t)-d):I(t);case 218:return t=l.getUint16(c),u>=(c+=2)?a.slice(c-d,(c+=t)-d):C(t);case 219:return t=l.getUint32(c),u>=(c+=4)?a.slice(c-d,(c+=t)-d):R(t);case 220:return t=l.getUint16(c),c+=2,F(t);case 221:return t=l.getUint32(c),c+=4,F(t);case 222:return t=l.getUint16(c),c+=2,E(t);case 223:return t=l.getUint32(c),c+=4,E(t);default:if(e>=224)return e-256;if(void 0===e){let e=Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw Error("Unknown MessagePack token "+e)}}}let b=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function M(e,t){function n(){if(n.count++>y){let n=e.read=Function("r","return function(){return "+(p.freezeData?"Object.freeze":"")+"({"+e.map((e=>"__proto__"===e?"__proto_:r()":b.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()")).join(",")+"})}")(w);return 0===e.highByte&&(e.read=T(t,e.read)),n()}let o={};for(let t=0,n=e.length;t<n;t++){let n=e[t];"__proto__"===n&&(n="__proto_"),o[n]=w()}return p.freezeData?Object.freeze(o):o}return n.count=0,0===e.highByte?T(t,n):n}let T=(e,t)=>function(){let o=n[c++];if(0===o)return t();let a=e<32?-(e+(o<<5)):e+(o<<5),r=i[a]||P()[a];if(!r)throw Error("Record id is not defined for "+a);return r.read||(r.read=M(r,e)),r.read()};function P(){let e=G((()=>(n=null,p.getStructures())));return i=p._mergeStructures(e,i)}var k=L,I=L,C=L,R=L;function L(e){let o;if(e<16&&(o=z(e)))return o;if(e>64&&t)return t.decode(n.subarray(c,c+=e));let i=c+e,a=[];for(o="";c<i;){let e=n[c++];if(128&e)if(192==(224&e)){let t=63&n[c++];a.push((31&e)<<6|t)}else if(224==(240&e)){let t=63&n[c++],o=63&n[c++];a.push((31&e)<<12|t<<6|o)}else if(240==(248&e)){let t=(7&e)<<18|(63&n[c++])<<12|(63&n[c++])<<6|63&n[c++];t>65535&&(t-=65536,a.push(t>>>10&1023|55296),t=56320|1023&t),a.push(t)}else a.push(e);else a.push(e);a.length>=4096&&(o+=D.apply(String,a),a.length=0)}return a.length>0&&(o+=D.apply(String,a)),o}function F(e){let t=Array(e);for(let n=0;n<e;n++)t[n]=w();return p.freezeData?Object.freeze(t):t}function E(e){if(p.mapsAsObjects){let t={};for(let n=0;n<e;n++){let e=Y();"__proto__"===e&&(e="__proto_"),t[e]=w()}return t}{let t=new Map;for(let n=0;n<e;n++)t.set(w(),w());return t}}var D=String.fromCharCode;function B(e){let t=c,o=Array(e);for(let i=0;i<e;i++){let e=n[c++];if((128&e)>0)return void(c=t);o[i]=e}return D.apply(String,o)}function z(e){if(e<4){if(e<2){if(0===e)return"";{let e=n[c++];return(128&e)>1?void(c-=1):D(e)}}{let t=n[c++],o=n[c++];if((128&t)>0||(128&o)>0)return void(c-=2);if(e<3)return D(t,o);let i=n[c++];return(128&i)>0?void(c-=3):D(t,o,i)}}{let t=n[c++],o=n[c++],i=n[c++],a=n[c++];if((128&t)>0||(128&o)>0||(128&i)>0||(128&a)>0)return void(c-=4);if(e<6){if(4===e)return D(t,o,i,a);{let e=n[c++];return(128&e)>0?void(c-=5):D(t,o,i,a,e)}}if(e<8){let r=n[c++],s=n[c++];if((128&r)>0||(128&s)>0)return void(c-=6);if(e<7)return D(t,o,i,a,r,s);let l=n[c++];return(128&l)>0?void(c-=7):D(t,o,i,a,r,s,l)}{let r=n[c++],s=n[c++],l=n[c++],p=n[c++];if((128&r)>0||(128&s)>0||(128&l)>0||(128&p)>0)return void(c-=8);if(e<10){if(8===e)return D(t,o,i,a,r,s,l,p);{let e=n[c++];return(128&e)>0?void(c-=9):D(t,o,i,a,r,s,l,p,e)}}if(e<12){let d=n[c++],u=n[c++];if((128&d)>0||(128&u)>0)return void(c-=10);if(e<11)return D(t,o,i,a,r,s,l,p,d,u);let h=n[c++];return(128&h)>0?void(c-=11):D(t,o,i,a,r,s,l,p,d,u,h)}{let d=n[c++],u=n[c++],h=n[c++],f=n[c++];if((128&d)>0||(128&u)>0||(128&h)>0||(128&f)>0)return void(c-=12);if(e<14){if(12===e)return D(t,o,i,a,r,s,l,p,d,u,h,f);{let e=n[c++];return(128&e)>0?void(c-=13):D(t,o,i,a,r,s,l,p,d,u,h,f,e)}}{let g=n[c++],m=n[c++];if((128&g)>0||(128&m)>0)return void(c-=14);if(e<15)return D(t,o,i,a,r,s,l,p,d,u,h,f,g,m);let x=n[c++];return(128&x)>0?void(c-=15):D(t,o,i,a,r,s,l,p,d,u,h,f,g,m,x)}}}}}function U(){let e,t=n[c++];if(t<192)e=t-160;else switch(t){case 217:e=n[c++];break;case 218:e=l.getUint16(c),c+=2;break;case 219:e=l.getUint32(c),c+=4;break;default:throw Error("Expected string")}return L(e)}function O(e){return p.copyBuffers?Uint8Array.prototype.slice.call(n,c,c+=e):n.subarray(c,c+=e)}function N(e){let t=n[c++];if(h[t]){let o;return h[t](n.subarray(c,o=c+=e),(e=>{c=e;try{return w()}finally{c=o}}))}throw Error("Unknown extension type "+t)}var X=Array(4096);function Y(){let e=n[c++];if(!(e>=160&&e<192))return c--,w().toString();if(e-=160,u>=c)return a.slice(c-d,(c+=e)-d);if(!(0==u&&o<180))return k(e);let t,i=4095&(e<<5^(e>1?l.getUint16(c):e>0?n[c]:0)),r=X[i],s=c,p=c+e-3,h=0;if(r&&r.bytes==e){for(;s<p;){if((t=l.getUint32(s))!=r[h++]){s=1879048192;break}s+=4}for(p+=3;s<p;)if((t=n[s++])!=r[h++]){s=1879048192;break}if(s===p)return c=s,r.string;p-=3,s=c}for(r=[],X[i]=r,r.bytes=e;s<p;)t=l.getUint32(s),r.push(t),s+=4;for(p+=3;s<p;)t=n[s++],r.push(t);let f=e<16?z(e):B(e);return r.string=null!=f?f:k(e)}let V=(e,t)=>{let n=w().map((e=>e.toString())),o=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,n.highByte=t);let a=i[e];return a&&(a.isShared||x)&&((i.restoreStructures||(i.restoreStructures=[]))[e]=a),i[e]=n,n.read=M(n,o),n.read()};h[0]=()=>{},h[0].noBuffer=!0;let j={Error,TypeError,ReferenceError};h[101]=()=>{let e=w();return(j[e[0]]||Error)(e[1])},h[105]=e=>{let t=l.getUint32(c-4);s||(s=new Map);let o,i=n[c];o=i>=144&&i<160||220==i||221==i?[]:{};let a={target:o};s.set(t,a);let r=w();return a.used?Object.assign(o,r):(a.target=r,r)},h[112]=e=>{let t=l.getUint32(c-4),n=s.get(t);return n.used=!0,n.target},h[115]=()=>new Set(w());let _=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((e=>e+"Array")),W="object"==typeof globalThis?globalThis:window;h[116]=e=>{let t=e[0],n=_[t];if(!n)throw Error("Could not find typed array for code "+t);return new W[n](Uint8Array.prototype.slice.call(e,1).buffer)},h[120]=()=>{let e=w();return RegExp(e[0],e[1])};let $=[];function G(e){let t=o,h=c,f=d,g=u,m=a,y=s,A=r,v=new Uint8Array(n.slice(0,o)),S=i,w=i.slice(0,i.length),b=p,M=x,T=e();return o=t,c=h,d=f,u=g,a=m,s=y,r=A,n=v,x=M,(i=S).splice(0,i.length,...w),p=b,l=new DataView(n.buffer,n.byteOffset,n.byteLength),T}function q(){n=null,s=null,i=null}h[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],n=c;return c+=t-e.length,r=$,(r=[U(),U()]).position0=0,r.position1=0,r.postBundlePosition=c,c=n,w()},h[255]=e=>4==e.length?new Date(1e3*(16777216*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+1e3*(4294967296*(3&e[3])+16777216*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+1e3*((128&e[4]?-281474976710656:0)+1099511627776*e[6]+4294967296*e[7]+16777216*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])):new Date("invalid");let J=Array(147);for(let e=0;e<256;e++)J[e]=+("1e"+Math.floor(45.15-.30103*e));var K=new A({useRecords:!1});let H,Z=K.unpack,Q=K.unpackMultiple,ee=K.unpack,te={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4},ne=new Float32Array(1),oe=new Uint8Array(ne.buffer,0,4);try{H=new TextEncoder}catch(e){}let ie,ae,re,se,le,ce,pe="undefined"!=typeof Buffer,de=pe?function(e){return Buffer.allocUnsafeSlow(e)}:Uint8Array,ue=pe?Buffer:Uint8Array,he=pe?4294967296:2144337920,fe=0,ge=null,me=/[\u0080-\uFFFF]/,xe=Symbol("record-id");class ye extends A{constructor(e){super(e),this.offset=0;let t,n,o,i,a=ue.prototype.utf8Write?function(e,t){return re.utf8Write(e,t,4294967295)}:!!H&&!!H.encodeInto&&function(e,t){return H.encodeInto(e,re.subarray(t)).written},r=this;e||(e={});let s=e&&e.sequential,l=e.structures||e.saveStructures,c=e.maxSharedStructures;if(null==c&&(c=l?32:0),c>8160)throw Error("Maximum maxSharedStructure is 8160");e.structuredClone&&null==e.moreTypes&&(this.moreTypes=!0);let p=e.maxOwnStructures;null==p&&(p=l?32:64),this.structures||0==e.useRecords||(this.structures=[]);let d=c>32||p+c>64,u=c+64,h=c+p+64;if(h>8256)throw Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let f=[],g=0,m=0;this.pack=this.encode=function(e,a){if(re||(le=(re=new de(8192)).dataView||(re.dataView=new DataView(re.buffer,0,8192)),fe=0),(ce=re.length-10)-fe<2048?(le=(re=new de(re.length)).dataView||(re.dataView=new DataView(re.buffer,0,re.length)),ce=re.length-10,fe=0):fe=fe+7&2147483640,t=fe,a&Fe&&(fe+=255&a),i=r.structuredClone?new Map:null,r.bundleStrings&&"string"!=typeof e?(ge=[]).size=1/0:ge=null,o=r.structures){o.uninitialized&&(o=r._mergeStructures(r.getStructures()));let e=o.sharedLength||0;if(e>c)throw Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+o.sharedLength);if(!o.transitions){o.transitions=Object.create(null);for(let t=0;t<e;t++){let e=o[t];if(!e)continue;let n,i=o.transitions;for(let t=0,o=e.length;t<o;t++){let o=e[t];(n=i[o])||(n=i[o]=Object.create(null)),i=n}i[xe]=t+64}this.lastNamedStructuresLength=e}s||(o.nextId=e+64)}n&&(n=!1);try{r.randomAccessStructure&&e&&e.constructor&&e.constructor===Object?k(e):A(e);let n=ge;if(ge&&we(t,A,0),i&&i.idsToInsert){let e=i.idsToInsert.sort(((e,t)=>e.offset>t.offset?1:-1)),o=e.length,a=-1;for(;n&&o>0;){let i=e[--o].offset+t;i<n.stringsPosition+t&&-1===a&&(a=0),i>n.position+t?a>=0&&(a+=6):(a>=0&&(le.setUint32(n.position+t,le.getUint32(n.position+t)+a),a=-1),n=n.previous,o++)}a>=0&&n&&le.setUint32(n.position+t,le.getUint32(n.position+t)+a),(fe+=6*e.length)>ce&&M(fe),r.offset=fe;let s=function(e,t){let n,o=6*t.length,i=e.length-o;for(;n=t.pop();){let t=n.offset,a=n.id;e.copyWithin(t+o,t,i);let r=t+(o-=6);e[r++]=214,e[r++]=105,e[r++]=a>>24,e[r++]=a>>16&255,e[r++]=a>>8&255,e[r++]=255&a,i=t}return e}(re.subarray(t,fe),e);return i=null,s}return r.offset=fe,a&Re?(re.start=t,re.end=fe,re):re.subarray(t,fe)}finally{if(o&&(x(),n&&r.saveStructures)){var l,p;let n=o.sharedLength||0,i=re.subarray(t,fe),s=(p=r,(l=o).isCompatible=e=>{let t=!e||(p.lastNamedStructuresLength||0)===e.length;return t||p._mergeStructures(e),t},l);return!1===r.saveStructures(s,s.isCompatible)?r.pack(e,a):(r.lastNamedStructuresLength=n,i)}a&Le&&(fe=t)}};let x=()=>{m<10&&m++;let e=o.sharedLength||0;if(o.length>e&&!s&&(o.length=e),g>1e4)o.transitions=null,m=0,g=0,f.length>0&&(f=[]);else if(f.length>0&&!s){for(let e=0,t=f.length;e<t;e++)f[e][xe]=0;f=[]}},y=e=>{var t=e.length;t<16?re[fe++]=144|t:t<65536?(re[fe++]=220,re[fe++]=t>>8,re[fe++]=255&t):(re[fe++]=221,le.setUint32(fe,t),fe+=4);for(let n=0;n<t;n++)A(e[n])},A=e=>{fe>ce&&(re=M(fe));var n,o=typeof e;if("string"===o){let o,i=e.length;if(ge&&i>=4&&i<4096){if((ge.size+=i)>21760){let e,n,o=(ge[0]?3*ge[0].length+ge[1].length:0)+10;fe+o>ce&&(re=M(fe+o)),ge.position?(n=ge,re[fe]=200,fe+=3,re[fe++]=98,e=fe-t,fe+=4,we(t,A,0),le.setUint16(e+t-3,fe-t-e)):(re[fe++]=214,re[fe++]=98,e=fe-t,fe+=4),(ge=["",""]).previous=n,ge.size=0,ge.position=e}let n=me.test(e);return ge[n?0:1]+=e,re[fe++]=193,void A(n?-i:i)}o=i<32?1:i<256?2:i<65536?3:5;let r=3*i;if(fe+r>ce&&(re=M(fe+r)),i<64||!a){let t,a,r,s=fe+o;for(t=0;t<i;t++)(a=e.charCodeAt(t))<128?re[s++]=a:a<2048?(re[s++]=a>>6|192,re[s++]=63&a|128):55296==(64512&a)&&56320==(64512&(r=e.charCodeAt(t+1)))?(a=65536+((1023&a)<<10)+(1023&r),t++,re[s++]=a>>18|240,re[s++]=a>>12&63|128,re[s++]=a>>6&63|128,re[s++]=63&a|128):(re[s++]=a>>12|224,re[s++]=a>>6&63|128,re[s++]=63&a|128);n=s-fe-o}else n=a(e,fe+o);n<32?re[fe++]=160|n:n<256?(o<2&&re.copyWithin(fe+2,fe+1,fe+1+n),re[fe++]=217,re[fe++]=n):n<65536?(o<3&&re.copyWithin(fe+3,fe+2,fe+2+n),re[fe++]=218,re[fe++]=n>>8,re[fe++]=255&n):(o<5&&re.copyWithin(fe+5,fe+3,fe+3+n),re[fe++]=219,le.setUint32(fe,n),fe+=4),fe+=n}else if("number"===o)if(e>>>0===e)e<32||e<128&&!1===this.useRecords||e<64&&!this.randomAccessStructure?re[fe++]=e:e<256?(re[fe++]=204,re[fe++]=e):e<65536?(re[fe++]=205,re[fe++]=e>>8,re[fe++]=255&e):(re[fe++]=206,le.setUint32(fe,e),fe+=4);else if((0|e)===e)e>=-32?re[fe++]=256+e:e>=-128?(re[fe++]=208,re[fe++]=e+256):e>=-32768?(re[fe++]=209,le.setInt16(fe,e),fe+=2):(re[fe++]=210,le.setInt32(fe,e),fe+=4);else{let t;if((t=this.useFloat32)>0&&e<4294967296&&e>=-2147483648){let n;if(re[fe++]=202,le.setFloat32(fe,e),t<4||(0|(n=e*J[(127&re[fe])<<1|re[fe+1]>>7]))===n)return void(fe+=4);fe--}re[fe++]=203,le.setFloat64(fe,e),fe+=8}else if("object"===o||"function"===o)if(e){if(i){let n=i.get(e);if(n){if(!n.id){let e=i.idsToInsert||(i.idsToInsert=[]);n.id=e.push(n)}return re[fe++]=214,re[fe++]=112,le.setUint32(fe,n.id),void(fe+=4)}i.set(e,{offset:fe-t})}let a=e.constructor;if(a===Object)b(e,!0);else if(a===Array)y(e);else if(a===Map)if(this.mapAsEmptyObject)re[fe++]=128;else for(let[t,o]of((n=e.size)<16?re[fe++]=128|n:n<65536?(re[fe++]=222,re[fe++]=n>>8,re[fe++]=255&n):(re[fe++]=223,le.setUint32(fe,n),fe+=4),e))A(t),A(o);else{for(let t=0,n=ie.length;t<n;t++)if(e instanceof ae[t]){let n=ie[t];if(n.write){n.type&&(re[fe++]=212,re[fe++]=n.type,re[fe++]=0);let t=n.write.call(this,e);return void(t===e?Array.isArray(e)?y(e):b(e):A(t))}let o,i=re,a=le,r=fe;re=null;try{o=n.pack.call(this,e,(e=>(re=i,i=null,(fe+=e)>ce&&M(fe),{target:re,targetView:le,position:fe-e})),A)}finally{i&&(re=i,le=a,fe=r,ce=re.length-10)}return void(o&&(o.length+fe>ce&&M(o.length+fe),fe=Se(o,re,fe,n.type)))}if(Array.isArray(e))y(e);else{if(e.toJSON){let t=e.toJSON();if(t!==e)return A(t)}if("function"===o)return A(this.writeFunction&&this.writeFunction(e));b(e,!e.hasOwnProperty)}}}else re[fe++]=192;else if("boolean"===o)re[fe++]=e?195:194;else if("bigint"===o){if(e<BigInt(1)<<BigInt(63)&&e>=-(BigInt(1)<<BigInt(63)))re[fe++]=211,le.setBigInt64(fe,e);else if(e<BigInt(1)<<BigInt(64)&&e>0)re[fe++]=207,le.setBigUint64(fe,e);else{if(!this.largeBigIntToFloat)throw RangeError(e+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");re[fe++]=203,le.setFloat64(fe,Number(e))}fe+=8}else{if("undefined"!==o)throw Error("Unknown type: "+o);this.encodeUndefinedAsNil?re[fe++]=192:(re[fe++]=212,re[fe++]=0,re[fe++]=0)}},v=this.variableMapSize||this.coercibleKeyAsNumber?e=>{let t,n=Object.keys(e),o=n.length;if(o<16?re[fe++]=128|o:o<65536?(re[fe++]=222,re[fe++]=o>>8,re[fe++]=255&o):(re[fe++]=223,le.setUint32(fe,o),fe+=4),this.coercibleKeyAsNumber)for(let i=0;i<o;i++){let o=Number(t=n[i]);A(isNaN(o)?t:o),A(e[t])}else for(let i=0;i<o;i++)A(t=n[i]),A(e[t])}:(e,n)=>{re[fe++]=222;let o=fe-t;fe+=2;let i=0;for(let t in e)(n||e.hasOwnProperty(t))&&(A(t),A(e[t]),i++);re[o+++t]=i>>8,re[o+t]=255&i},S=!1===this.useRecords?v:e.progressiveRecords&&!d?(e,n)=>{let i,a,r=o.transitions||(o.transitions=Object.create(null)),s=fe++-t;for(let l in e)if(n||e.hasOwnProperty(l)){if(i=r[l])r=i;else{let n=Object.keys(e),c=r;r=o.transitions;let p=0;for(let e=0,t=n.length;e<t;e++){let t=n[e];!(i=r[t])&&(i=r[t]=Object.create(null),p++),r=i}s+t+1==fe?(fe--,T(r,n,p)):P(r,n,s,p),a=!0,r=c[l]}A(e[l])}if(!a){let n=r[xe];n?re[s+t]=n:P(r,Object.keys(e),s,0)}}:(e,t)=>{let n,i=o.transitions||(o.transitions=Object.create(null)),a=0;for(let o in e)(t||e.hasOwnProperty(o))&&(!(n=i[o])&&(n=i[o]=Object.create(null),a++),i=n);let r=i[xe];for(let n in r?r>=96&&d?(re[fe++]=96+(31&(r-=96)),re[fe++]=r>>5):re[fe++]=r:T(i,i.__keys__||Object.keys(e),a),e)(t||e.hasOwnProperty(n))&&A(e[n])},w="function"==typeof this.useRecords&&this.useRecords,b=w?(e,t)=>{w(e)?S(e,t):v(e,t)}:S,M=e=>{let n;if(e>16777216){if(e-t>he)throw Error("Packed buffer would be larger than maximum buffer size");n=Math.min(he,4096*Math.round(Math.max((e-t)*(e>67108864?1.25:2),4194304)/4096))}else n=1+(Math.max(e-t<<2,re.length-1)>>12)<<12;let o=new de(n);return le=o.dataView||(o.dataView=new DataView(o.buffer,0,n)),e=Math.min(e,re.length),re.copy?re.copy(o,0,t,e):o.set(re.slice(t,e)),fe-=t,t=0,ce=o.length-10,re=o},T=(e,t,i)=>{let a=o.nextId;a||(a=64),a<u&&this.shouldShareStructure&&!this.shouldShareStructure(t)?((a=o.nextOwnId)<h||(a=u),o.nextOwnId=a+1):(a>=h&&(a=u),o.nextId=a+1);let r=t.highByte=a>=96&&d?a-96>>5:-1;e[xe]=a,e.__keys__=t,o[a-64]=t,a<u?(t.isShared=!0,o.sharedLength=a-63,n=!0,r>=0?(re[fe++]=96+(31&a),re[fe++]=r):re[fe++]=a):(r>=0?(re[fe++]=213,re[fe++]=114,re[fe++]=96+(31&a),re[fe++]=r):(re[fe++]=212,re[fe++]=114,re[fe++]=a),i&&(g+=m*i),f.length>=p&&(f.shift()[xe]=0),f.push(e),A(t))},P=(e,n,o,i)=>{let a=re,r=fe,s=ce,l=t;re=se,fe=0,t=0,re||(se=re=new de(8192)),ce=re.length-10,T(e,n,i),se=re;let c=fe;if(re=a,fe=r,ce=s,t=l,c>1){let e=fe+c-1;e>ce&&M(e);let n=o+t;re.copyWithin(n+c,n+1,fe),re.set(se.slice(0,c),n),fe=e}else re[o+t]=se[0]},k=(e,i)=>{let a=(void 0)(e,re,t,fe,o,M,((e,t,o)=>{if(o)return n=!0;fe=t;let i=re;return A(e),x(),i!==re?{position:fe,targetView:le,target:re}:fe}),this);if(0===a)return b(e,!0);fe=a}}useBuffer(e){re=e,le=new DataView(re.buffer,re.byteOffset,re.byteLength),fe=0}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}function Ae(e,t,n,o){let i=e.byteLength;if(i+1<256){var{target:a,position:r}=n(4+i);a[r++]=199,a[r++]=i+1}else if(i+1<65536){var{target:a,position:r}=n(5+i);a[r++]=200,a[r++]=i+1>>8,a[r++]=i+1&255}else{var{target:a,position:r,targetView:s}=n(7+i);a[r++]=201,s.setUint32(r,i+1),r+=4}a[r++]=116,a[r++]=t,a.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),r)}function ve(e,t){let n=e.byteLength;if(n<256){var o,i,{target:o,position:i}=t(n+2);o[i++]=196,o[i++]=n}else if(n<65536){var{target:o,position:i}=t(n+3);o[i++]=197,o[i++]=n>>8,o[i++]=255&n}else{var{target:o,position:i,targetView:a}=t(n+5);o[i++]=198,a.setUint32(i,n),i+=4}o.set(e,i)}function Se(e,t,n,o){let i=e.length;switch(i){case 1:t[n++]=212;break;case 2:t[n++]=213;break;case 4:t[n++]=214;break;case 8:t[n++]=215;break;case 16:t[n++]=216;break;default:i<256?(t[n++]=199,t[n++]=i):i<65536?(t[n++]=200,t[n++]=i>>8,t[n++]=255&i):(t[n++]=201,t[n++]=i>>24,t[n++]=i>>16&255,t[n++]=i>>8&255,t[n++]=255&i)}return t[n++]=o,t.set(e,n),n+i}function we(e,t,n){if(ge.length>0){le.setUint32(ge.position+e,fe+n-ge.position-e),ge.stringsPosition=fe-e;let o=ge;ge=null,t(o[0]),t(o[1])}}ae=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,g],ie=[{pack(e,t,n){let o=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&o>=0&&o<4294967296){let{target:e,targetView:n,position:i}=t(6);e[i++]=214,e[i++]=255,n.setUint32(i,o)}else if(o>0&&o<4294967296){let{target:n,targetView:i,position:a}=t(10);n[a++]=215,n[a++]=255,i.setUint32(a,4e6*e.getMilliseconds()+(o/1e3/4294967296|0)),i.setUint32(a+4,o)}else if(isNaN(o)){if(this.onInvalidDate)return t(0),n(this.onInvalidDate());let{target:e,targetView:o,position:i}=t(3);e[i++]=212,e[i++]=255,e[i++]=255}else{let{target:n,targetView:i,position:a}=t(15);n[a++]=199,n[a++]=12,n[a++]=255,i.setUint32(a,1e6*e.getMilliseconds()),i.setBigInt64(a+4,BigInt(Math.floor(o)))}}},{pack(e,t,n){if(this.setAsEmptyObject)return t(0),n({});let o=Array.from(e),{target:i,position:a}=t(this.moreTypes?3:0);this.moreTypes&&(i[a++]=212,i[a++]=115,i[a++]=0),n(o)}},{pack(e,t,n){let{target:o,position:i}=t(this.moreTypes?3:0);this.moreTypes&&(o[i++]=212,o[i++]=101,o[i++]=0),n([e.name,e.message])}},{pack(e,t,n){let{target:o,position:i}=t(this.moreTypes?3:0);this.moreTypes&&(o[i++]=212,o[i++]=120,o[i++]=0),n([e.source,e.flags])}},{pack(e,t){this.moreTypes?Ae(e,16,t):ve(pe?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let n=e.constructor;n!==ue&&this.moreTypes?Ae(e,_.indexOf(n.name),t):ve(e,t)}},{pack(e,t){let{target:n,position:o}=t(1);n[o]=193}}];let be=new ye({useRecords:!1}),Me=be.pack,Te=be.pack,{NEVER:Pe,ALWAYS:ke,DECIMAL_ROUND:Ie,DECIMAL_FIT:Ce}=te,Re=512,Le=1024,Fe=2048;e.ALWAYS=ke,e.C1=m,e.DECIMAL_FIT=Ce,e.DECIMAL_ROUND=Ie,e.Decoder=A,e.Encoder=ye,e.FLOAT32_OPTIONS=te,e.NEVER=Pe,e.Packr=ye,e.REUSE_BUFFER_MODE=Re,e.Unpackr=A,e.addExtension=function(e){var t;if(e.Class){if(!e.pack&&!e.write)throw Error("Extension has no pack or write function");if(e.pack&&!e.type)throw Error("Extension has no type (numeric code to identify the extension)");ae.unshift(e.Class),ie.unshift(e)}(t=e).unpack?h[t.type]=t.unpack:h[t.type]=t},e.clearSource=q,e.decode=ee,e.decodeIter=function(e,t={}){if(!e||"object"!=typeof e)throw Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise");let n,o=new A(t),i=e=>{let t;n&&(e=Buffer.concat([n,e]),n=void 0);try{t=o.unpackMultiple(e)}catch(o){if(!o.incomplete)throw o;n=e.slice(o.lastPosition),t=o.values}return t};return"function"==typeof e[Symbol.iterator]?function*(){for(let t of e)yield*i(t)}():"function"==typeof e[Symbol.asyncIterator]?async function*(){for await(let t of e)yield*i(t)}():void 0},e.encode=Te,e.encodeIter=function(e,t={}){if(e&&"object"==typeof e){if("function"==typeof e[Symbol.iterator])return function*(e,t){let n=new ye(t);for(let t of e)yield n.pack(t)}(e,t);if("function"==typeof e.then||"function"==typeof e[Symbol.asyncIterator])return async function*(e,t){let n=new ye(t);for await(let t of e)yield n.pack(t)}(e,t);throw Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise")}throw Error("first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable")},e.isNativeAccelerationEnabled=!1,e.mapsAsObjects=!0,e.pack=Me,e.roundFloat32=function(e){ne[0]=e;let t=J[(127&oe[3])<<1|oe[2]>>7];return(t*e+(e>0?.5:-.5)|0)/t},e.unpack=Z,e.unpackMultiple=Q,e.useRecords=!1},"object"==typeof exports&&"undefined"!=typeof module?H(exports):"function"==typeof define&&define.amd?define(["exports"],H):H((K="undefined"!=typeof globalThis?globalThis:K||self).msgpackr={});const Z=Object.freeze({sensitivity:13e3,minAvgSpeed:650,maxScrollTime:150,edgeMargin:117}),Q=A.A.environment="undefined"==typeof location?"server":location.origin.endsWith("8080")||location.href.endsWith("editor")?"editor":"client";!1==(A.A.isProd="undefined"==typeof location||!location.origin.startsWith("http://localhost"))&&(window.s={},setInterval((()=>{for(let e in A.A)window.s[e]=A.A[e]}),1e3));const ee={};function te(e,t,n){const o=e+"_"+t+"_"+n;if(void 0!==ee[o])return ee[o];const i=parseInt(e.slice(1,3),16),a=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16),s=parseInt(t.slice(1,3),16),l=parseInt(t.slice(3,5),16),c=parseInt(t.slice(5,7),16),p=(d=Math.floor(i*(1-n)+s*n),u=Math.floor(a*(1-n)+l*n),h=Math.floor(r*(1-n)+c*n),"#"+ne(d)+ne(u)+ne(h));var d,u,h;return ee[o]=p,p}function ne(e){var t=e.toString(16);return 1==t.length?"0"+t:t}A.A.blendColor=te;const oe="server"===Q?null:localStorage.getItem("mapsBeaten");if(A.A.mapsBeaten={},null!==oe){const e=oe.split("|");for(let t=0;t<e.length;t++)A.A.mapsBeaten[e[t]]=!0}A.A.decorationImgs={},"undefined"!=typeof Image?(A.A.arrowImg=new Image,A.A.starImg=new Image,A.A.starImg.crossOrigin="Anonymous","editor"===Q?(async()=>{const e=await i.e(254).then(i.bind(i,230));A.A.arrowImg=e.default.arrowImg,A.A.starImg=e.default.starImg})():(A.A.arrowImg.src="./gfx/arrow.png",A.A.starImg.src="https://upload.wikimedia.org/wikipedia/commons/c/c3/A_Snapshot_of_the_Jewel_Box_cluster_with_the_ESO_VLT.jpg")):A.A.arrowImg=A.A.starImg={},window.colourRgb=(e,t,n)=>(e=2.55*Math.max(Math.min(Number(e),100),0),t=2.55*Math.max(Math.min(Number(t),100),0),n=2.55*Math.max(Math.min(Number(n),100),0),"#"+(e=("0"+(Math.round(e)||0).toString(16)).slice(-2))+(t=("0"+(Math.round(t)||0).toString(16)).slice(-2))+("0"+(Math.round(n)||0).toString(16)).slice(-2)),"server"===Q&&(global.colourRgb=window.colourRgb),window.md=e=>e!=e||null==e?0:e,window.makeNumber=e=>!0===Number.isFinite(e)?e:0,window.makeNotNaN=e=>e==e?e:0,window.makeNotNull=e=>null===e?0:e,window.makeNotUndefined=e=>void 0===e?0:e,window.rlt=e=>(A.A.loopTrap=1e3,e),window.makeType=(e,t)=>!0===t.includes(A.A.generateConnectionType(e))?e:ie[typeof e],A.A.generateConnectionType=e=>{const t=typeof e;return"number"===t?"Number":"string"===t?["String","Colour"]:"boolean"===t?"Boolean":!0===Array.isArray(e)?"Array":null};const ie={undefined:0,string:"",boolean:!0,number:0,object:[]},ae=new TextEncoder,re=new TextDecoder;let se=function(){let e=[];return["nigger","nigga","chink","ching chong","onrender","trash version","evades.","zerotix","zero tix","zero","0tix","cunt","asshole","porn","hentai","slut","whore","faggot","on render","fake evades","real evades"].forEach((t=>{e.push("(\\S*"+t.replace(/[aа]/gim,"[aа4]").replace(/[cс]/gim,"[cс]").replace(/[eеё]/gim,"[eеё3]").replace(/[oо]/gim,"[oо0]").replace(/[pр]/gim,"[pр]").replace(/[tт]/gim,"[tт]").replace(/[yу]/gim,"[yу]").replace(/[hн]/gim,"[hн]").replace(/[kк]/gim,"[kк]").replace(/[xх]/gim,"[xх]").replace(/[bв]/gim,"[bв]").replace(/[nп]/gim,"[nп]").replace(/[mм]/gim,"[mм]").replace(/[i1]/gim,"[i1]").replace(/[ _\-]/gim,"[ _\\-]")+"\\S*)")})),new RegExp(e.join("|"),"gmi")}();const le={until:(e,t=400)=>!!e()||new Promise((n=>{let o=setInterval((()=>{e()&&(clearInterval(o),n())}),t)})),SCROLL_PARAMS:Z,blendColor:te,environment:Q,encodeAtPosition:function(e,t,n){return ae.encodeInto(e,n?t.subarray(0|n):t)},decodeText:function(e,t=0,n=1/0){return re.decode(e).slice(t,n)},stringHTMLSafe:function(e){return e.replace(/&/g,"&amp;").replace(/ /g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},filterText:function(e){return e.replace(se,"[https://evadesx.io/]")}},{decodeText:ce,filterText:pe,stringHTMLSafe:de}=le,ue=location.origin.replace(/^http/,"ws");let he,fe,ge,me=!1,xe=!1,ye=!1;A.A.mapEntryTime=0,A.A.disconnected=!1;const Ae=[];A.A.send=e=>{Ae.push(e)},!1===A.A.isEditor&&(he=new WebSocket(ue),he.binaryType="arraybuffer",he.addEventListener("message",(function(e){if(void 0!==fe)return be[fe](e.data),void(fe=void 0);const t=new Uint8Array(e.data);void 0===be[t[0]]&&console.log(t),be[t[0]](t)})),he.onopen=()=>{console.log("connected to the server!"),A.A.send=e=>{he.send(e)};for(let e=0;e<Ae.length;e++)A.A.send(Ae[e])},he.onclose=()=>{null!==A.A.username&&(A.A.disconnected=!0),console.log("Websocket closed."),A.A.send=()=>{}}),A.A.changeMap=function(e="/maps/hub",t="GET",n=new Headers,o=e=>{console.error(`failed to load map url ${e}`)}){ye=!1,A.A.mapEntryTime=window.frames,n.append("id",A.A.authId),fetch(location.origin+e,{method:t,headers:n}).then((async t=>{const n=await t.text();if("n"===n)return void o(e);const[i,a]=JSON.parse(t.headers.get("X-Init-Data")),r=document.getElementById("gameScript");null!==r&&r.remove(),A.A.resetGame(),A.A.mapPath=e,A.A.players.length=A.A.obstacles.length=0,xe=!0;const s=document.createElement("script");s.id="gameScript",s.text=n,document.body.appendChild(s);for(let e=0;e<i.length;e++){if(void 0===i[e]||null===i[e]){A.A.players[e]=void 0;continue}const t=Me(i[e]);A.A.players[e]=t}A.A.selfId=a,A.A.won=!1,me?A.A.respawnPlayer():(A.A.startGame(),me=!0)}))},window.loadMap=e=>{!1!==xe&&(xe=!1,e(A.A),void 0!==ge?(ge(),ge=void 0):ye=!0)};const ve={};function Se(e,t){let n=document.getElementById(`leaderboard-map-${t}`);if(null===n){n=document.createElement("div"),n.classList.add("lb-group"),n.id=`leaderboard-map-${t}`;const e=A.A.mapDifficulties[t]??ve[t]??0,o=de(A.A.mapLeaderboardNames[t]??t),i=document.createElement("span");n.appendChild(i),i.classList.add("lb-name"),i.style.color="winroom"===t?"#3528e0":A.A.difficultyImageColors[Math.floor(e)],i.innerHTML=o,we.appendChild(n)}const o=document.createElement("div");o.id=`player-container-${e}-${t}`,o.classList.add("lb-players"),n.appendChild(o);const i=document.createElement("div");o.appendChild(i);const a=document.createElement("span");a.classList.add("player-name"),a.innerHTML=e,i.appendChild(a)}A.A.addChatMessage=(e,t)=>{const n=document.createElement("div");"system"!==t?n.classList.add("chat-message"):n.classList.add("system-message"),n.innerHTML={normal:"",system:'<span class="rainbow">[SERVER]</span>',dev:'<span class="rainbow">[DEV]</span>',guest:'<span class="guest">'}[t]+e+{normal:"",system:"",dev:"",guest:"</span>"}[t];const o=document.querySelector(".chat-div");o.appendChild(n),o.scrollTop=o.scrollHeight};const we=document.querySelector(".leaderboard-div"),be=[e=>{const t=new Uint32Array(e.buffer);A.A.authId=t[1];const n=A.A.username=localStorage.getItem("username"),o=localStorage.getItem("password");if(null===n||null===o)window.onkeydown({code:"KeyZ",repeat:!1,type:"keydown"}),A.A.changeMap("/tutorial");else{const e=new Headers;e.append("u",n),e.append("p",o),A.A.changeMap("/join","POST",e)}},()=>{location.reload()},e=>{location.replace(location.origin+"/create")},e=>{fe=e[1]},e=>{const t=e.buffer,n=new Uint16Array(t)[1];if(n===A.A.selfId)return;const o=new Float32Array(t);A.A.players[n].pos.x=o[1],A.A.players[n].pos.y=o[2]},e=>{let t=Me(msgpackr.unpack(e));A.A.players[t.id]=t},e=>{let t=new Uint16Array(e.buffer)[1];A.A.players[t]=void 0},e=>{A.A.addChatMessage(de(pe(ce(e,2))),["normal","system","dev","guest"][e[1]])},e=>{const t=new Uint16Array(e.buffer)[1];t!==A.A.selfId&&(A.A.players[t].god=1===e[1])},e=>{const t=new Uint16Array(e.buffer)[1];if(t===A.A.selfId)return;const n=new Float32Array(e.buffer);A.A.players[t].ship=!0,A.A.players[t].shipAngle=n[1]},e=>{const t=new Uint16Array(e.buffer)[1];t!==A.A.selfId&&(A.A.players[t].ship=!1)},e=>{const t=new Uint16Array(e.buffer)[1];if(t===A.A.selfId)return;const n=new Float32Array(e.buffer);A.A.players[t].grapple=!0,A.A.players[t].grappleX=n[1],A.A.players[t].grappleY=n[2]},e=>{const t=new Uint16Array(e.buffer)[1];t!==A.A.selfId&&(A.A.players[t].grapple=!1)},e=>{const t=new Uint16Array(e.buffer)[1];if(t===A.A.selfId)return;const n=new Float32Array(e.buffer);A.A.players[t].deathTimer=!0,A.A.players[t].deathTime=n[1]},e=>{const t=new Uint16Array(e.buffer)[1];t!==A.A.selfId&&(A.A.players[t].deathTimer=!1)},e=>{const t=new Uint16Array(e.buffer)[1];t!==A.A.selfId&&(A.A.players[t].dead=1===e[1])},e=>{const t=e[1],n=ce(e,2,t+2);Se(de(ce(e,t+2)),n)},e=>{const t=e[1],n=ce(e,2,t+2),o=de(ce(e,t+2));document.getElementById(`player-container-${o}-${n}`).remove();let i=document.getElementById(`leaderboard-map-${n}`);1===i.children.length&&i.remove()},e=>{const t=e[1],n=e[2],o=ce(e,8,t+8),i=de(ce(e,t+8,e.byteLength-n)),a=A.A.mapDifficulties[o]??0,r=de(A.A.mapLeaderboardNames[o]??o),s=new Uint32Array(e.buffer)[1]/1e3;let l=(~~(100*s)%100).toString(),c=(~~(s%60)).toString(),p=(~~(s/60%60)).toString();1===l.length&&(l="0"+l),1===c.length&&(c="0"+c);let d=`${p}:${c}.${l}`;s>3600&&(1===p.length&&(p="0"+p),d=`${(~~(s/3600)).toString()}:${p}:${c}.${l}`);const u=document.createElement("div");u.classList.add("system-message"),u.classList.add(`difficulty-${Math.floor(a)}`),u.innerHTML=`<span class="rainbow">[SƎRVƎR]</span>: ${i} ${["has beaten","completed","surmounted","finished"][Math.floor(4*Math.random())]} the ${r} in ${d}!`;const h=document.querySelector(".chat-div");h.appendChild(u),h.scrollTop=h.scrollHeight},e=>{e[0]=222;const t=msgpackr.unpack(e);for(let e in t)for(let n in t[e])Se(t[e][n],e)},e=>{if(0===A.A.obstacles.length)return;A.A.generateSyncMaps();let t,n=0,o=[],i=!1,a=-2;for(let e=0;e<A.A.obstacles.length;e++){const r=A.A.obstacles[e];if(void 0!==r.customSync)o[n]=r.customSync(r),i=!0;else{o[n]={},i=!1;for(let e=0;e<r.simulate.length;e++)t=A.A.simulateToSync.get(r.simulate[e]),void 0===t?(t=A.A.idleEffectToSync.get(r.simulate[e]),void 0===t?i=!1:i||=!1!==t(r,o[n])):i||=!1!==t(r,o[n])}!0===i&&(a!==e-1&&(o[n].id=e),a=e,n++)}if(0===o.length)return;!1===i&&o.length--;const r=msgpackr.pack(o);r[0]=21,A.A.send(r)},e=>{ge=()=>{let t;A.A.generateApplySyncMaps(),e[0]=220;try{t=msgpackr.unpack(e)}catch(t){return console.log("failed sync map parsing!",e),void console.error(t)}if(!1===Array.isArray(t)||void 0===t[0].id)return;let n,o,i=t[0].id;for(let e=0;e<t.length;e++){n=t[e].id,void 0===n?n=++i:i=n;const a=A.A.obstacles[n];if(void 0!==a)if(void 0===a.applyCustomSync)for(let n=0;n<a.simulate.length;n++)o=A.A.simulateToApplySync.get(a.simulate[n]),void 0===o?(o=A.A.idleEffectToApplySync.get(a.simulate[n]),void 0===o||o(a,t[e])):o(a,t[e]);else a.applyCustomSync(a,t[e])}};const t=A.A.offtabSync;if(!0!==ye&&!0!==A.A.offtabSync||(ge(),ge=void 0,A.A.offtabSync=!1,ye=!1),!0===t)A.A.accum=0;else{const e=(window.frames-A.A.mapEntryTime)/2;if(e>2e3)return;A.A.accum+=A.A.FRAME_TIME*e}},e=>{const t=new Uint16Array(e.buffer)[1];if(t===A.A.selfId)return;const n=new Float32Array(e.buffer);A.A.players[t].sat.r=n[1]},e=>{const t=new Float32Array(e.buffer)[1],n=ce(e,8).replaceAll("\0","");ve[n]=t},e=>{A.A.accum=0,A.A.offtabSync=!1}];function Me(e){const t=A.A.createPlayer();return t.pos.x=e.pos.x,t.pos.y=e.pos.y,t.sat.r=e.r,t.name=e.name,t.dead=e.dead,t.id=e.id,t.god=e.god,t.ship=e.ship,t.shipAngle=e.shipAngle,t.grapple=e.grapple,t.grappleX=e.grappleX,t.grappleY=e.grappleY,t.deathTimer=e.deathTimer,t.deathTime=e.deathTime,t}const{until:Te,environment:Pe}=le;let ke;const Ie=()=>void 0!==ke;let Ce=!0==("undefined"==typeof location)?"":`${location.origin}/game`,Re=!1,Le="",Fe=[],Ee=[];if(A.A.levelFileName="",A.A.isExClient=!0,"editor"===Pe||"server"===Pe||!0===A.A.isExClient)ze=async()=>{await Te((()=>!1))},Be=()=>{};else if(!0===location.href.includes("standalone")){A.A.standalone=!0;const e=location.href.split("/");Ce+="/"+e[e.length-1],Be=()=>{}}else if(null===localStorage.getItem("tutorialCompleted")){let e=!1;ze=async()=>(await Te((()=>!1!==e)),ze()),A.A.tutorial=!0,(async()=>{ze=(await i.e(186).then(i.bind(i,186))).default,e=!0})()}ze().then((async e=>{ke=e,Oe(),!0!==A.A.standalone?ke=await De:ze=async()=>{await Te((()=>!1))}}));let De=ze();async function Be(e=!1){if(!0!==Re){if(!0===e){if(0===Fe.length)return;var t=ke;Ee.push(A.A.levelFileName),ke=await Ue(Fe.pop())}else""!==A.A.levelFileName&&(Fe.push(A.A.levelFileName),Fe.length>42&&Fe.shift(),0!==Ee.length&&(ke=await Ue(Ee.pop())));A.A.scrollingUp=!0===e,A.A.lastObstacles=[];for(let e=0;e<obstacles.length;e++)A.A.lastObstacles.push(obstacles[e]);for(let e in A.A.colors)A.A.lastColors[e]=A.A.colors[e],A.A.colors[e]=A.A.defaultColors[e];A.A.lastPlayerData=[player.pos.x,player.pos.y],void 0!==ke?(Oe(),A.A.scrollAnimation=0,ke=!0===e?t:await ze()):(Re=!0,removeScript(),A.A.scrollAnimation=0,await Te(Ie,16.66),Oe(),Re=!1,ke=await ze())}}async function ze(){const e=await fetch(Ce);if(!e.ok)throw new Error(`Failed to fetch ${Ce}`);return Le=e.headers.get("Fn"),e.text()}async function Ue(e){const t=e.slice(0,e.length-3),n=await fetch(Ce+"/"+t);if(!n.ok)throw new Error(`Failed to fetch ${Ce}`);return Le=e,n.text()}async function Oe(){removeScript(),A.A.resetGame(),stopMusic();const e=document.createElement("script");e.id="gameScript",e.text=ke,document.body.appendChild(e),ke=void 0,A.A.levelFileName=Le}A.A.won=!1,A.A.removeScript=function(){const e=document.getElementById("gameScript");null!==e&&e.remove(),A.A.resetGame(),stopMusic()},A.A.resetFns=[],A.A.resetGame=()=>{for(let e=0;e<A.A.resetFns.length;e++)A.A.resetFns[e]();A.A.resetFns.length=A.A.obstacles.length=A.A.mouseUpFunctions.length=A.A.mouseDownFunctions.length=A.A.mouseMoveFunctions.length=A.A.resizeFns.length=0,"editor"!==A.A.environment?(A.A.respawnPlayer(),A.A.changeCameraScale(1)):(A.A.infiniteLoop=!1,A.A.onEditorReset());for(let e in A.A.defaultColors)A.A.colors[e]=A.A.defaultColors[e];void 0!==A.A.colors.vignette&&(A.A.colors.vignette=structuredClone(A.A.defaultColors.vignette)),A.A.mouseDownFunctions.push((()=>{!0===e.dead&&A.A.respawnPlayer()})),void 0!==A.A.addSideMenuEvtListeners&&A.A.addSideMenuEvtListeners(Le),A.A.spawnPosition.x=100,A.A.spawnPosition.y=100,A.A.mapDimensions.x=2e3,A.A.mapDimensions.y=2e3,A.A.camera.numControlledBy=0;const e=A.A.players[A.A.selfId];void 0!==e&&(e.sat.r=49.5,e.speed=e.baseSpeed=7.167),A.A.idToObs={}};const Ne=Be,{environment:Xe,blendColor:Ye,encodeAtPosition:Ve}=le;let je=!1;A.A.respawnPlayer=()=>{const e=A.A.players[A.A.selfId];void 0!==e&&(e.pos.x=A.A.spawnPosition.x,e.pos.y=A.A.spawnPosition.y,e.renderRadius=0,e.dead=!1,e.forces.length=0,!0===A.A.dragging?(window.onmouseup(),A.A.dragging=!0):window.onmouseup())};const _e=window.SAT;function We(e,t,n,o){const a={sat:et[e](o),simulate:[],effect:[],renderShape:at[e],renderEffect:n.map((e=>xt[e])),renderEffectTimer:0};a.pos=a.sat.pos,0===e?a.sat.r=Math.max(a.sat.r,.001):3===e?(a.isText=!0,a.text=o.text,a.fontSize=o.fontSize):4===e&&(a.sat.r=Math.max(a.sat.r,.001),a.innerRadius=Math.max(o.innerRadius,0),a.startSlice=o.startSlice,a.startSliceAngle=o.startSliceAngle,a.endSlice=o.endSlice,a.endSliceAngle=o.endSliceAngle,a.startSliceAngleRotateSpeed=o.startSliceAngleRotateSpeed,a.endSliceAngleRotateSpeed=o.endSliceAngleRotateSpeed,void 0!==o.circleSliceRotate&&a.simulate.push(o.circleSliceRotate));for(let t in A.A.satConstraintsMap[e]){const n=A.A.satConstraintsMap[e][t];!0===n[2]&&(a[t]=Math.round(a[t])),a[t]<n[0]?a[t]=n[0]:a[t]>n[1]&&(a[t]=n[1])}a.dimensions=nt(a),a.topLeft=ot(a);for(let e=0;e<t.length;e++){a.simulate.push(st[t[e]]),rt[t[e]](a,o);for(let n in A.A.simulateConstraintsMap[t[e]]){const o=A.A.simulateConstraintsMap[t[e]][n];!0===o[2]&&(a[n]=Math.round(a[n])),a[n]<o[0]?a[n]=o[0]:a[n]>o[1]&&(a[n]=o[1])}}for(let e=0;e<n.length;e++){a.effect.push(ht[n[e]]),dt[n[e]](a,o),void 0!==ft[n[e]]&&a.simulate.push(ft[n[e]]);for(let t in A.A.effectConstraintsMap[n[e]]){const o=A.A.effectConstraintsMap[n[e]][t];!0===o[2]&&(a[t]=Math.round(a[t])),a[t]<o[0]?a[t]=o[0]:a[t]>o[1]&&(a[t]=o[1])}}void 0!==o.sf&&a.simulate.push(o.sf),void 0!==o.ef&&(a.effect.push(o.ef),a.renderEffect.push(xt[3])),void 0===o.sf&&void 0===o.ef||(a.simulate.push((()=>{a.dimensions=nt(a),a.topLeft=ot(a)})),void 0!==o.customSync&&void 0!==o.applyCustomSync&&(a.customSync=o.customSync,a.applyCustomSync=o.applyCustomSync)),void 0!==o.cr&&(a.cr=o.cr),vt.push(a),void 0!==o.fixPoly&&("editor"===Xe?(a.sat.setPoints(A.A.fixPolygon(o.points).map((e=>new _e.Vector(e[0],e[1])))),a.dimensions=nt(a),a.topLeft=ot(a)):(async()=>{await i.e(281).then(i.bind(i,281)),a.sat.setPoints(A.A.fixPolygon(o.points).map((e=>new _e.Vector(e[0],e[1])))),a.dimensions=nt(a),a.topLeft=ot(a)})())}function $e(e,t,n){return(1-n)*e+n*t}_e.Circle.prototype.rotate=function(e){this.pos.rotate(e)},A.A.C=We,A.A.idToObs={},A.A.tickFns=[],A.A.R=function(e){if(e===vt.length-1){do{vt.pop()}while(!0===vt[vt.length-1].removed);return}const t=vt[e];t.simulate.length=t.effect.length=0,delete t.sf,delete t.ef,delete t.cr,t.pos.x=-1e9,t.removed=!0};let Ge,qe=new _e.Response,Je=!1,Ke=new _e.Vector,He=new _e.Vector;const Ze=A.A.testCircleSliceCircle=(e,t,n)=>{let o,i,a,r,s,l=!1;return o=Math.atan2(t.pos.y-e.pos.y,t.pos.x-e.pos.x),o<0&&(o+=2*Math.PI),a=e.startSliceAngle<o,r=o<e.endSliceAngle,s=e.startSliceAngle>e.endSliceAngle,(!0===s?!0===a||!0===r:!0===a&&!0===r)&&(l=_e.testCircleCircle(e.sat,t.sat,n),!0===l)?(i=(t.pos.y-e.pos.y)**2+(t.pos.x-e.pos.x)**2,i>((e.innerRadius+e.sat.r+t.sat.r)/2)**2||(i<=(e.innerRadius-t.sat.r)**2?(n.clear(),n.overlapN.x=n.overlapN.y=0,n.overlapV.x=n.overlapV.y=0,!1):(n.overlapN=n.overlapN.scale(-1,-1),n.overlap=e.sat.r-e.innerRadius+2*t.sat.r-n.overlap,n.overlapV=new _e.Vector(n.overlapN.x*n.overlap,n.overlapN.y*n.overlap),!0))):!(Math.abs((e.startSliceAngle-e.endSliceAngle)%(2*Math.PI))<.001)&&(Ke.x=Ke.y=0,He.x=He.y=0,!0===_e.testPolygonCircle(e.startSlice,t.sat,n)&&(l=!0,Ke.x+=n.overlapN.x,Ke.y+=n.overlapN.y,He.x+=n.overlapV.x,He.y+=n.overlapV.y,n.clear(),n.overlapN.x=n.overlapN.y=0,n.overlapV.x=n.overlapV.y=0),l||=_e.testPolygonCircle(e.endSlice,t.sat,n),n.overlapN.x+=Ke.x,n.overlapN.y+=Ke.y,n.overlapN=n.overlapN.normalize(),n.overlapV.x+=He.x,n.overlapV.y+=He.y,n.overlap=n.overlapV.x/n.overlapN.x,l)},Qe=[_e.testCircleCircle,_e.testCirclePolygon,_e.testPolygonCircle,_e.testPolygonPolygon];A.A.collide=(e,t)=>(qe.hasCollided=Qe[2*(void 0===e.sat.r)+(void 0===t.sat.r)](e.sat,t.sat,qe),qe),A.A.boundAB=(e,t)=>{const n=A.A.collide(e,t);!0===n.hasCollided&&(e.pos.x-=n.overlapV.x,e.pos.y-=n.overlapV.y),n.clear()},A.A.isABColliding=(e,t)=>{if(void 0===e||void 0===t)return!1;const n=A.A.collide(e,t),o=n.hasCollided;return n.clear(),o};const et=[e=>new _e.Circle(new _e.Vector(e.x,e.y),e.r),e=>new _e.Box(new _e.Vector(e.x,e.y),e.w,e.h).toPolygon(),e=>{e.points.length<2&&(e.points=A.A.satDefaultMap[2].points),e.x=0,e.y=0;const t=new _e.Polygon(new _e.Vector,e.points.map((e=>new _e.Vector(e[0],e[1]))));return t.pos.x=e.x,t.pos.y=e.y,t},e=>{if(!0===A.A.isServer)return new _e.Box(new _e.Vector(e.x,e.y),100,100).toPolygon();ctx.textAlign="center",ctx.textBaseline="middle",ctx.font=`${e.fontSize}px Inter`;const t=ctx.measureText(e.text),n=t.actualBoundingBoxRight+t.actualBoundingBoxLeft,o=t.actualBoundingBoxDescent+t.actualBoundingBoxAscent;return new _e.Box(new _e.Vector(e.x-n/2,e.y-o/2),n,o).toPolygon()},e=>{const t=new _e.Circle(new _e.Vector(e.x,e.y),e.r),n=e;return n.startSliceAngle%=2*Math.PI,n.endSliceAngle%=2*Math.PI,n.startSliceAngle<0&&(n.startSliceAngle+=2*Math.PI),n.endSliceAngle<0&&(n.endSliceAngle+=2*Math.PI),n.startSlice=new _e.Polygon(new _e.Vector,[new _e.Vector(Math.cos(n.startSliceAngle)*n.r,Math.sin(n.startSliceAngle)*n.r),new _e.Vector(Math.cos(n.startSliceAngle)*n.innerRadius,Math.sin(n.startSliceAngle)*n.innerRadius)]),n.endSlice=new _e.Polygon(new _e.Vector,[new _e.Vector(Math.cos(n.endSliceAngle)*n.r,Math.sin(n.endSliceAngle)*n.r),new _e.Vector(Math.cos(n.endSliceAngle)*n.innerRadius,Math.sin(n.endSliceAngle)*n.innerRadius)]),n.startSlice.pos=n.endSlice.pos=t.pos,0===e.startSliceAngleRotateSpeed&&0===e.endSliceAngleRotateSpeed||(e.circleSliceRotate=e=>{e.startSliceAngle+=e.startSliceAngleRotateSpeed,e.endSliceAngle+=e.endSliceAngleRotateSpeed,e.startSliceAngle%=2*Math.PI,e.endSliceAngle%=2*Math.PI,e.startSliceAngle<0&&(e.startSliceAngle+=2*Math.PI),e.endSliceAngle<0&&(e.endSliceAngle+=2*Math.PI),e.startSlice.setPoints([new _e.Vector(Math.cos(e.startSliceAngle)*e.sat.r,Math.sin(e.startSliceAngle)*e.sat.r),new _e.Vector(Math.cos(e.startSliceAngle)*e.innerRadius,Math.sin(e.startSliceAngle)*e.innerRadius)]),e.endSlice.setPoints([new _e.Vector(Math.cos(e.endSliceAngle)*e.sat.r,Math.sin(e.endSliceAngle)*e.sat.r),new _e.Vector(Math.cos(e.endSliceAngle)*e.innerRadius,Math.sin(e.endSliceAngle)*e.innerRadius)]),e.startSlice.pos=e.endSlice.pos=e.sat.pos}),t}];function tt(){const e=A.A.obstacles;for(let t=0;t<e.length;t++){if(!0!==e[t].isText)continue;const n=e[t].dimensions;e[t].dimensions=nt(e[t]),e[t].pos.x+=(n.x-e[t].dimensions.x)/2,e[t].pos.y+=(n.y-e[t].dimensions.y)/2,e[t].topLeft=ot(e[t])}}function nt(e){const t=e.sat;if(void 0!==t.r)return{x:2*t.r,y:2*t.r};let n,o,i,a;i=o=-1/0,n=a=1/0;for(let e of t.points)e.x<a&&(a=e.x),e.x>o&&(o=e.x),e.y>i&&(i=e.y),e.y<n&&(n=e.y);return{x:o-a,y:i-n}}function ot(e){let t=e.pos.x,n=e.pos.y;if(void 0!==e.sat.r)t-=e.sat.r,n-=e.sat.r;else{let o=1/0,i=1/0;for(let t=0;t<e.sat.points.length;t++)e.sat.points[t].x<o&&(o=e.sat.points[t].x),e.sat.points[t].y<i&&(i=e.sat.points[t].y);t+=o,n+=i}return{x:t,y:n}}setTimeout(tt,1e3),setTimeout(tt,3e3),A.A.generateDimensions=nt,A.A.generateTopLeftCoordinates=ot,A.A.satMapI2N=["circle","rectangle","polygon","text","circleSlice"],A.A.satConstraintsMap=[void 0,void 0,void 0,{fontSize:[1]},void 0],A.A.satDefaultMap=[{x:300,y:100,r:100},{x:0,y:0,w:200,h:200},{points:[[0,400],[50,200],[150,200],[200,400]]},{x:300,y:250,text:"Text",fontSize:80},{x:300,y:300,r:100,innerRadius:50,startSliceAngle:0,endSliceAngle:Math.PI,startSliceAngleRotateSpeed:0,endSliceAngleRotateSpeed:0}];const it=2*Math.PI,at=[e=>{ctx.arc(e.pos.x,e.pos.y,e.sat.r,0,it)},e=>{void 0===e.rotation?ctx.rect(e.topLeft.x,e.topLeft.y,e.dimensions.x,e.dimensions.y):at[2](e)},e=>{for(let t=0;t<e.sat.points.length;t++)ctx.lineTo(e.pos.x+e.sat.points[t].x,e.pos.y+e.sat.points[t].y);ctx.lineTo(e.pos.x+e.sat.points[0].x,e.pos.y+e.sat.points[0].y)},e=>{at[1](e)},e=>{ctx.moveTo(e.pos.x+Math.cos(e.startSliceAngle)*e.innerRadius,e.pos.y+Math.sin(e.startSliceAngle)*e.innerRadius),ctx.lineTo(e.pos.x+Math.cos(e.startSliceAngle)*e.sat.r,e.pos.y+Math.sin(e.startSliceAngle)*e.sat.r),ctx.arc(e.pos.x,e.pos.y,e.sat.r,e.startSliceAngle,e.endSliceAngle),ctx.lineTo(e.pos.x+Math.cos(e.endSliceAngle)*e.innerRadius,e.pos.y+Math.sin(e.endSliceAngle)*e.innerRadius),0!==e.innerRadius&&ctx.arc(e.pos.x,e.pos.y,e.innerRadius,e.endSliceAngle,e.startSliceAngle,!0)}],rt=[(e,t)=>{e.path=t.path;for(let t=e.path.length-1;t>=1;t--)e.path[t][0]===e.path[t-1][0]&&e.path[t][1]===e.path[t-1][1]&&e.path.splice(t,1);e.path.length<2&&(e.path=A.A.simulateDefaultMap[0].path),e.currentPoint=Math.floor(t.currentPoint)%e.path.length,e.pointOn=e.path[e.currentPoint],e.speed=e.pointOn[2];let n=e.currentPoint+1;n===e.path.length&&(n=0),e.pointTo=e.path[n],Ge=Math.atan2(e.pointTo[1]-e.pointOn[1],e.pointTo[0]-e.pointOn[0]),e.xv=Math.cos(Ge)*e.speed,e.yv=Math.sin(Ge)*e.speed,e.timeRemain=Math.sqrt((e.pointOn[0]-e.pointTo[0])**2+(e.pointOn[1]-e.pointTo[1])**2)/e.speed;const o=t.currentPoint-Math.floor(t.currentPoint);if(0!==o){const t=e.timeRemain*(1-o),n=e.timeRemain-t;e.pos.x+=n*e.xv,e.pos.y+=n*e.yv,e.timeRemain=t}e.pos.x+=e.pointOn[0]-e.path[0][0],e.pos.y+=e.pointOn[1]-e.path[0][1]},(e,t)=>{e.pivotX=t.pivotX,e.pivotY=t.pivotY,e.rotation=0,0!==t.initialRotation&&void 0!==t.initialRotation&&(e.rotateSpeed=t.initialRotation,st[1](e)),e.rotateSpeed=t.rotateSpeed},(e,t)=>{e.growSpeed=t.growSpeed,e.shrinkSpeed=t.shrinkSpeed,e.maxGrowth=t.maxGrowth,e.minGrowth=t.minGrowth,e.growing=t.toStartGrowing,e.growth=e.lastGrowth=t.startGrowth,e.growPivotX=t.growPivotX,e.growPivotY=t.growPivotY},()=>{},(e,t)=>{let n=t.id.toString().trim();void 0!==A.A.idToObs[n]&&"editor"===Xe&&alert(`Warning! Duplicate id "${n}" found! Duplicate ids override each other.`),A.A.idToObs[n]=e},(e,t)=>{e.toRest=t.toRest,e.restAngles=t.restAngles,e.homingRotateSpeed=t.homingRotateSpeed,e.rotation=0,e.detectionRadiusSquared=t.detectionRadius**2,e.spokeAngles=t.spokeAngles,e.pivotX=t.pivotX,e.pivotY=t.pivotY}],st=[e=>{if(e.pos.x+=e.xv,e.pos.y+=e.yv,e.timeRemain--,e.timeRemain<=0){e.currentPoint++,e.currentPoint===e.path.length&&(e.currentPoint=0),e.pointOn=e.path[e.currentPoint],e.speed=e.pointOn[2],e.pos.x+=e.xv*e.timeRemain,e.pos.y+=e.yv*e.timeRemain;let t=e.currentPoint+1;t===e.path.length&&(t=0),e.pointTo=e.path[t],Ge=Math.atan2(e.pointTo[1]-e.pointOn[1],e.pointTo[0]-e.pointOn[0]),e.xv=Math.cos(Ge)*e.speed,e.yv=Math.sin(Ge)*e.speed;let n=Math.sqrt((e.pointOn[0]-e.xv*e.timeRemain-e.pointTo[0])**2+(e.pointOn[1]-e.yv*e.timeRemain-e.pointTo[1])**2);(e.xv**2+e.yv**2)*e.timeRemain**2>n?n=Math.sqrt((e.pointOn[0]-e.pointTo[0])**2+(e.pointOn[1]-e.pointTo[1])**2):(e.pos.x-=e.xv*e.timeRemain,e.pos.y-=e.yv*e.timeRemain),e.timeRemain=n/e.speed}e.topLeft=A.A.generateTopLeftCoordinates(e)},e=>{void 0!==e.sat.r?(e.pos.x-=e.pivotX,e.pos.y-=e.pivotY,e.sat.rotate(e.rotateSpeed),e.pos.x+=e.pivotX,e.pos.y+=e.pivotY):(e.sat.translate(e.pos.x-e.pivotX,e.pos.y-e.pivotY),e.sat.rotate(e.rotateSpeed),e.sat.translate(e.pivotX-e.pos.x,e.pivotY-e.pos.y)),e.rotation+=e.rotateSpeed,e.dimensions=nt(e),e.topLeft=A.A.generateTopLeftCoordinates(e)},e=>{!0===e.growing?(e.growth+=e.growSpeed,e.growth>=e.maxGrowth&&(e.growing=!1,e.growth=e.maxGrowth)):(e.growth-=e.shrinkSpeed,e.growth<=e.minGrowth&&(e.growing=!0,e.growth=e.minGrowth));const t=e.growth/e.lastGrowth;if(void 0!==e.sat.r)e.pos.x-=e.growPivotX,e.pos.y-=e.growPivotY,e.pos.x*=t,e.pos.y*=t,e.pos.x+=e.growPivotX,e.pos.y+=e.growPivotY,e.sat.r*=t;else{for(let n=0;n<e.sat.points.length;n++)e.sat.points[n].x+=e.pos.x-e.growPivotX,e.sat.points[n].y+=e.pos.y-e.growPivotY,e.sat.points[n].x*=t,e.sat.points[n].y*=t,e.sat.points[n].x-=e.pos.x-e.growPivotX,e.sat.points[n].y-=e.pos.y-e.growPivotY;e.sat.setPoints(e.sat.points),!0===e.isText&&(e.fontSize*=t)}e.topLeft=ot(e),e.dimensions=nt(e),e.lastGrowth=e.growth},()=>{},()=>{},(e,t)=>{let n=e.topLeft.x+e.dimensions.x/2,o=e.topLeft.y+e.dimensions.y/2;if(!0===t.dead||(t.pos.x-n)**2+(t.pos.y-o)**2>e.detectionRadiusSquared){if(!1===e.toRest)return;let t=1/0;for(let n=0;n<e.restAngles.length;n++){let o=lt(e.rotation,e.restAngles[n]);Math.abs(o)<Math.abs(t)&&(t=o)}if(t===1/0)return;return Math.abs(t)<e.homingRotateSpeed?e.rotateSpeed=t:e.rotateSpeed=Math.sign(t)*e.homingRotateSpeed,void st[1](e)}Ge=Math.atan2(t.pos.y-o,t.pos.x-n);let i=1/0;for(let t=0;t<e.spokeAngles.length;t++){let n=lt(e.spokeAngles[t]+e.rotation,Ge);Math.abs(n)<Math.abs(i)&&(i=n)}i!==1/0&&(Math.abs(i)<e.homingRotateSpeed?e.rotateSpeed=i:e.rotateSpeed=Math.sign(i)*e.homingRotateSpeed,st[1](e))}];function lt(e,t){let n=(t-e)%it;return 2*n%it-n}A.A.simulateMapI2N=["pathMove","rotate","grow","custom","id","rotateHoming"],A.A.simulateDefaultMap=[{currentPoint:0,path:[[0,0,2],[50,0,1],[-50,0,2]]},{initialRotation:0,rotateSpeed:.01,pivotX:300,pivotY:100},{growSpeed:.006,shrinkSpeed:.006,maxGrowth:1.25,minGrowth:1,startGrowth:1,toStartGrowing:!0,growPivotX:100,growPivotY:300},{},{id:"uniqueId"},{toRest:!0,restAngles:[0,Math.PI],homingRotateSpeed:.01,detectionRadius:200,spokeAngles:[0,Math.PI],pivotX:300,pivotY:300}],A.A.simulateConstraintsMap=[{currentPoint:[0]},void 0,{growSpeed:[0],shrinkSpeed:[0],minGrowth:[.001],maxGrowth:[.001]},void 0,void 0];const ct=[(e,t)=>{t.x=e.pos.x,t.y=e.pos.y;const n=Math.sqrt((e.pointOn[0]-e.pointTo[0])**2+(e.pointOn[1]-e.pointTo[1])**2)/e.speed;t.currentPoint=e.currentPoint+(1-e.timeRemain/n)},(e,t)=>{if(0===e.rotateSpeed)return!1;t.initialRotation=e.rotation},void 0,void 0,void 0,void 0],pt=[(e,t)=>{!1!==Number.isFinite(t.x+t.y+t.currentPoint)&&(t.path=e.path,rt[0](e,t),e.pos.x=t.x,e.pos.y=t.y)},(e,t)=>{if(!1===Number.isFinite(t.initialRotation))return;const n=t.initialRotation;t.initialRotation-=e.rotation,t.pivotX=e.pivotX,t.pivotY=e.pivotY,t.rotateSpeed=e.rotateSpeed,rt[1](e,t),e.rotation=n},void 0,void 0,void 0,void 0],dt=[()=>{},(e,t)=>{e.boundPlayer=t.boundPlayer??!1},(e,t)=>{e.bounciness=t.bounciness,e.decay=t.decay},()=>{},(e,t)=>{e.img="undefined"==typeof Image?{}:new Image,e.img.src=t.url,e.imgLoaded=!1,e.img.onload=()=>{e.imgLoaded=!0}},()=>{},(e,t)=>{e.isWinpad=!0},(e,t)=>{e.collected=!1,e.coinAmount=t.coinAmount,e.color=t.color},(e,t)=>{e.isCoindoor=!0,e.maxCoins=e.coins=t.coindoorCoinAmount,e.coinDoorColor=t.coinDoorColor},(e,t)=>{e.checkpointCollected=!1,e.checkpointOffsetX=t.checkpointOffsetX,e.checkpointOffsetY=t.checkpointOffsetY},(e,t)=>{e.maxStrength=t.maxStrength,e.strength=e.maxStrength,e.regenTime=t.regenTime,e.lastBrokeTime=-1e99,e.healSpeed=t.healSpeed},()=>{},(e,t)=>{e.tpx=t.tpx,e.tpy=t.tpy},(e,t)=>{e.conveyorForce=t.conveyorForce,e.conveyorAngle=t.conveyorAngle*Math.PI/180,e.conveyorAngleRotateSpeed=t.conveyorAngleRotateSpeed*Math.PI/180,e.conveyorFriction=t.conveyorFriction},(e,t)=>{e.platformerForce=t.platformerForce,e.platformerAngle=t.platformerAngle*Math.PI/180,e.platformerAngleRotateSpeed=t.platformerAngleRotateSpeed*Math.PI/180,e.platformerFriction=t.platformerFriction,e.maxJumpCooldown=t.maxJumpCooldown,e.jumpCooldown=0,e.jumpForce=t.jumpForce,e.jumpFriction=t.jumpDecay,e.canJumpMidair=t.canJumpMidair,e.midairStoredJump=!1,e.justJumped=!1,e.jumpForceObj={playerForceId:void 0},e.touchingPlatformer=!1,e.canJump=!1},(e,t)=>{e.axisSpeedMultX=t.axisSpeedMultX,e.axisSpeedMultY=t.axisSpeedMultY},(e,t)=>{e.toSnapX=t.toSnapX,e.toSnapY=t.toSnapY,e.snapDistanceX=t.snapDistanceX,e.snapDistanceY=t.snapDistanceY,e.snapCooldown=e.maxSnapCooldown=t.snapCooldown,e.snapAngle=t.snapAngle*Math.PI/180,e.snapCollided=!1,e.snapAngleRotateSpeed=t.snapAngleRotateSpeed*Math.PI/180,e.interpolatePlayerData={time:0,nextX:-1,nextY:-1},e.snapMagnitude=Math.sqrt(e.snapDistanceX**2+e.snapDistanceY**2)},(e,t)=>{e.timeTrapTime=e.timeTrapMaxTime=t.timeTrapMaxTime,e.timeTrapRecoverySpeed=t.timeTrapRecoverySpeed,e.timeTrapToKill=t.timeTrapToKill,e.timeTrapToShowTenth=t.timeTrapToShowTenth,e.timeTrapIntersecting=!1},(e,t)=>{e.sizeMult=t.sizeMult,e.sizeChangePermanent=t.sizeChangePermanent,e.lastChangeSizeColliding=e.changeSizeColliding=!1},(e,t)=>{e.speedMult=t.speedMult,e.speedChangePermanent=t.speedChangePermanent},(e,t)=>{e.hex=t.hex,e.alpha=t.alpha},(e,t)=>{e.cr=()=>{}},(e,t)=>{e.mapName=t.mapName,e.difficulty=A.A.mapDifficulties[t.mapName]??0,e.toCustomPlanet=t.toCustomPlanet},(e,t)=>{e.tornadoStrength=t.tornadoStrength},(e,t)=>{e.innerR=t.innerR,e.innerG=t.innerG,e.innerB=t.innerB,e.innerSize=t.innerSize,e.innerOpacity=t.innerOpacity,e.outerR=t.outerR,e.outerG=t.outerG,e.outerB=t.outerB,e.outerSize=t.outerSize,e.outerOpacity=t.outerOpacity},(e,t)=>{e.lastPushAngle=e.pushAngle=t.pushAngle*Math.PI/180,e.maxPushDistance=t.maxPushDistance,e.idlePushBackSpeed=t.idlePushBackSpeed,e.pushConversionRatio=t.pushConversionRatio,e.positiveDirectionOnly=t.positiveDirectionOnly,e.pushAngleVecX=Math.cos(e.pushAngle),e.pushAngleVecY=Math.sin(e.pushAngle),e.pushPercent=0},(e,t)=>{e.musicPath=t.musicPath,e.musicStartTime=t.musicStartTime},(e,t)=>{e.changeShipStateTo=t.changeShipStateTo,e.initialShipAngle=t.initialShipAngle,e.shipTurnSpeed=t.shipTurnSpeed},(e,t)=>{e.changeGrappleStateTo=t.changeGrappleStateTo,e.grappleRange=t.grappleRange,e.grappleForce=t.grappleForce,e.grappleFric=t.grappleFric},(e,t)=>{e.changeDeathTimerStateTo=t.changeDeathTimerStateTo,e.drainAmountWhileStandingOn=t.drainAmountWhileStandingOn,e.deathTime=t.deathTime;for(let t in A.A.effectDefaultMap[24])e[t]=A.A.effectDefaultMap[24][t];e.innerR=e.outerR=255}];let ut=-1;const ht=[(e,t,n,o)=>{e.pos.x+=t.overlapV.x,e.pos.y+=t.overlapV.y,e.touchingNormalIndexes.push(o)},(e,t,n)=>{t.overlap>1&&(e.dead=!0,!0===n.boundPlayer&&(e.pos.x+=t.overlapV.x,e.pos.y+=t.overlapV.y))},(e,t,n)=>{e.pos.x+=t.overlapV.x,e.pos.y+=t.overlapV.y,Ge=Math.atan2(t.overlapV.y,t.overlapV.x),e.forces.push(Math.cos(Ge)*n.bounciness,Math.sin(Ge)*n.bounciness,n.decay)},()=>{},()=>{},e=>{e.stopForces=!0},(e,t,n)=>{"editor"===Xe||!0===A.A.standalone?!0===A.A.isExClient?A.A.uploadCode():(A.A.respawnPlayer(),!0===A.A.inClearCheckMode&&(A.A.exitClearCheckMode(),uploadCode())):!0!==A.A.won&&(A.A.won=!0,!0===A.A.isExClient?"/maps/winroom"===A.A.mapPath?A.A.changeMap("/maps/hub"):(A.A.changeMap("/maps/winroom"),A.A.mapsBeaten[A.A.mapPath]=!0,localStorage.setItem("mapsBeaten",Object.keys(A.A.mapsBeaten).join("|"))):(je=!0,!0===A.A.tutorial&&A.A.beatCurrentTutorialMap()))},(e,t,n)=>{if(!0!==n.collected){n.collected=!0;for(let e=0;e<vt.length;e++)!0===vt[e].isCoindoor&&vt[e].coinDoorColor===n.color&&(vt[e].coins-=n.coinAmount)}},(e,t,n)=>{n.coins>0&&(e.pos.x+=t.overlapV.x,e.pos.y+=t.overlapV.y)},(e,t,n)=>{!0!==n.checkpointCollected&&(n.checkpointCollected=!0,A.A.spawnPosition.x=n.topLeft.x+n.dimensions.x/2,A.A.spawnPosition.y=n.topLeft.y+n.dimensions.y/2)},(e,t,n,o)=>{n.strength>0&&(e.pos.x+=t.overlapV.x,e.pos.y+=t.overlapV.y,n.strength--,n.strength<0&&(n.strength=0),e.touchingNormalIndexes.push(o)),n.lastBrokeTime=window.frames},(e,t,n)=>{e.onSafe=!0},(e,t,n)=>{e.pos.x=n.tpx,e.pos.y=n.tpy,e.renderRadius=Math.min(e.renderRadius,e.sat.r/2)},(e,t,n)=>{e.forces.push(Math.cos(n.conveyorAngle)*n.conveyorForce,Math.sin(n.conveyorAngle)*n.conveyorForce,n.conveyorFriction)},(e,t,n,o)=>{n.touchingPlatformer=!0,n.jumpCooldown--,e.forces.push(Math.cos(n.platformerAngle)*n.platformerForce,Math.sin(n.platformerAngle)*n.platformerForce,n.platformerFriction);const i=Math.atan2(e.yv,e.xv),a=n.platformerAngle-i,r=Math.cos(a)*Math.sqrt(e.yv**2+e.xv**2)/e.friction;e.pos.x-=Math.cos(n.platformerAngle)*r,e.pos.y-=Math.sin(n.platformerAngle)*r;const s=0!==e.touchingNormalIndexes.length||e.lastTouchingNormalIndexes[e.lastTouchingNormalIndexes.length-1]>=o&&!1===n.justJumped||!0===e.touchingWall;n.justJumped=!1,n.jumpCooldown<=0&&(!0===s||!0===n.canJumpMidair&&!0===n.midairStoredJump)?(n.midairStoredJump=n.midairStoredJump||s,n.canJump=!0,Math.abs(lt(n.platformerAngle+Math.PI,i))<.48*Math.PI&&-Math.sqrt(e.xv**2+e.yv**2)*Math.cos(a)>.1&&(e.forces.push(-Math.cos(n.platformerAngle)*n.jumpForce,-Math.sin(n.platformerAngle)*n.jumpForce,n.jumpFriction),n.jumpCooldown=n.maxJumpCooldown,n.midairStoredJump=!1,n.justJumped=!0)):n.canJump=!1},(e,t,n)=>{e.axisSpeedMultX*=n.axisSpeedMultX,e.axisSpeedMultY*=n.axisSpeedMultY},(e,t,n)=>{if(n.snapCooldown--,n.snapCollided=!0,n.snapCooldown<=0&&(!0===n.toSnapX&&Math.abs(e.xv)>.01||!0===n.toSnapY&&Math.abs(e.yv)>.01)){n.snapCooldown=n.maxSnapCooldown;let t=Math.atan2(!0===n.toSnapY?e.yv:0,!0===n.toSnapX?e.xv:0);n.interpolatePlayerData={time:Math.min(n.maxSnapCooldown-1,5),nextX:e.pos.x+Math.cos(t)*n.snapMagnitude*.95,nextY:e.pos.y+Math.sin(t)*n.snapMagnitude*.95}}if(n.interpolatePlayerData.time>1)n.interpolatePlayerData.time--,e.pos.x=.8*e.pos.x+.2*n.interpolatePlayerData.nextX,e.pos.y=.8*e.pos.y+.2*n.interpolatePlayerData.nextY;else{let t=n.topLeft.x+n.dimensions.x/2,o=n.topLeft.y+n.dimensions.y/2,i={angle:Math.atan2(e.pos.y-o,e.pos.x-t)-n.snapAngle,distance:Math.sqrt((e.pos.y-o)**2+(e.pos.x-t)**2)};i.x=Math.cos(i.angle)*i.distance,i.y=Math.sin(i.angle)*i.distance,!0===n.toSnapX&&(i.x=.4*i.x+Math.round(i.x/n.snapDistanceX)*n.snapDistanceX*.6),!0===n.toSnapY&&(i.y=.4*i.y+Math.round(i.y/n.snapDistanceY)*n.snapDistanceY*.6),i.angle=Math.atan2(i.y,i.x)+n.snapAngle,i.distance=Math.sqrt(i.y**2+i.x**2),e.pos.x=Math.cos(i.angle)*i.distance+t,e.pos.y=Math.sin(i.angle)*i.distance+o}},(e,t,n)=>{n.timeTrapIntersecting=!0,n.timeTrapTime--,n.timeTrapTime<0&&(!0===n.timeTrapToKill&&(e.dead=e.timeTrapOverrideSafe=!0),n.timeTrapTime=0)},(e,t,n)=>{n.sizeMult<1&&!1===n.lastChangeSizeColliding&&(t.clear(),e.sat.r*=n.sizeMult,Je=void 0!==n.sat.r?_e.testCircleCircle(n.sat,e.sat,t):_e.testPolygonCircle(n.sat,e.sat,t),e.sat.r/=n.sizeMult,!1===Je)||(!0===n.sizeChangePermanent&&void 0===n.permanentSizeChangeDone&&(n.permanentSizeChangeDone=!0,e.sat.r*=n.sizeMult),n.changeSizeColliding=!0)},(e,t,n)=>{!0===n.speedChangePermanent?void 0===n.permanentSpeedChangeDone&&(n.permanentSpeedChangeDone=!0,e.speed*=n.speedMult):(e.axisSpeedMultX*=n.speedMult,e.axisSpeedMultY*=n.speedMult)},(e,t,n)=>{},(e,t,n)=>{},(e,t,n)=>{if(!0!==A.A.won&&(A.A.won=!0,!0===A.A.isExClient))if(!0===n.toCustomPlanet&&void 0===n.changeMapBroken){const e=new Headers;e.append("mapname",n.mapName),A.A.changeMap("/customPlanet","GET",e,(()=>{A.A.won=!1,n.changeMapBroken=!0}))}else A.A.changeMap("/maps/"+n.mapName)},(e,t,n)=>{e.pos.x+=Math.cos(360*Math.random())*n.tornadoStrength,e.pos.y+=Math.sin(360*Math.random())*n.tornadoStrength},(e,t,n)=>{const o=A.A.colors.vignette;o.inner.r=n.innerR,o.inner.g=n.innerG,o.inner.b=n.innerB,o.inner.size=n.innerSize,o.inner.opacity=n.innerOpacity,o.outer.r=n.outerR,o.outer.g=n.outerG,o.outer.b=n.outerB,o.outer.size=n.outerSize,o.outer.opacity=n.outerOpacity},(e,t,n)=>{n.pushAngle!==n.lastPushAngle&&(n.lastPushAngle=n.pushAngle,n.pushAngleVecX=Math.cos(n.pushAngle),n.pushAngleVecY=Math.sin(n.pushAngle)),ut=-(n.pushAngleVecX*t.overlapV.x+n.pushAngleVecY*t.overlapV.y)*n.pushConversionRatio,(!1===n.positiveDirectionOnly||ut>0)&&(n.pushPercent+=ut/n.maxPushDistance,n.pushPercent>1?(ut-=(n.pushPercent-1)*n.maxPushDistance,n.pushPercent=1):n.pushPercent<0&&(ut-=n.pushPercent*n.maxPushDistance,n.pushPercent=0),n.pos.x+=n.pushAngleVecX*ut,n.pos.y+=n.pushAngleVecY*ut),t.clear(),Je=void 0!==n.sat.r?_e.testCircleCircle(n.sat,e.sat,t):_e.testPolygonCircle(n.sat,e.sat,t),!0===Je&&(e.pos.x+=t.overlapV.x,e.pos.y+=t.overlapV.y)},(e,t,n)=>{A.A.playMusic(n.musicPath,n.musicStartTime)},(e,t,n)=>{e.ship!==n.changeShipStateTo&&(!0===A.A.isExClient&&!1===n.changeShipStateTo&&(A.A.u4[0]=10,A.A.send(A.A.u4)),!1===e.ship&&!0===n.changeShipStateTo&&(e.shipAngle=n.initialShipAngle,e.shipTurnSpeed=n.shipTurnSpeed),e.ship=n.changeShipStateTo)},(e,t,n)=>{!0===e.grapple&&!1===n.changeGrappleStateTo&&(!0===A.A.isExClient&&(A.A.u4[0]=12,A.A.send(A.A.u4)),e.grappleX=e.grappleY=-1),e.grapple=n.changeGrappleStateTo,e.grappleRange=n.grappleRange,e.grappleForce=n.grappleForce,e.grappleFric=n.grappleFric},(e,t,n)=>{!0===A.A.isExClient&&!0===e.deathTimer&&!1===n.changeDeathTimerStateTo&&(A.A.u4[0]=14,A.A.send(A.A.u4)),!0===n.changeDeathTimerStateTo&&(!1===e.deathTimer?e.deathTime=n.deathTime:e.deathTime=Math.min(e.deathTime,n.deathTime),e.deathTime-=n.drainAmountWhileStandingOn,ht[24](e,t,n)),e.deathTimer=n.changeDeathTimerStateTo}],ft=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,e=>{e.strength<e.maxStrength&&window.frames-e.lastBrokeTime>e.regenTime&&(e.strength+=e.healSpeed,e.strength>=e.maxStrength&&(e.lastBrokeTime=window.frames,e.strength=e.maxStrength))},void 0,void 0,e=>{e.conveyorAngle+=e.conveyorAngleRotateSpeed},e=>{e.platformerAngle+=e.platformerAngleRotateSpeed},void 0,e=>{e.snapAngle+=e.snapAngleRotateSpeed,!1===e.snapCollided&&(e.interpolatePlayerData.time=-1),e.snapCollided=!1},e=>{!0!==e.timeTrapIntersecting&&(e.timeTrapTime+=e.timeTrapRecoverySpeed),e.timeTrapTime>e.timeTrapMaxTime&&(e.timeTrapTime=e.timeTrapMaxTime),e.timeTrapIntersecting=!1},(e,t)=>{!0!==e.sizeChangePermanent&&(!0===e.lastChangeSizeColliding&&!1===e.changeSizeColliding?t.sat.r/=e.sizeMult:!1===e.lastChangeSizeColliding&&!0===e.changeSizeColliding&&(t.sat.r*=e.sizeMult),e.lastChangeSizeColliding=e.changeSizeColliding,e.changeSizeColliding=!1)},void 0,void 0,void 0,void 0,void 0,void 0,(e,t)=>{ut=-e.idlePushBackSpeed,e.pushPercent+=ut/e.maxPushDistance,e.pushPercent>1?(ut-=(e.pushPercent-1)*e.maxPushDistance,e.pushPercent=1):e.pushPercent<0&&(ut-=e.pushPercent*e.maxPushDistance,e.pushPercent=0),e.pos.x+=ut*Math.cos(e.pushAngle),e.pos.y+=ut*Math.sin(e.pushAngle)},void 0,void 0,void 0,void 0];A.A.effectConstraintsMap=[void 0,void 0,{decay:[void 0,1]},void 0,void 0,void 0,void 0,{coinAmount:[1]},{coins:[1],maxCoins:[1]},void 0,{maxStrength:[1],regenTime:[0],healSpeed:[0]},void 0,void 0,{conveyorFriction:[void 0,1]},{platformerFriction:[void 0,1],jumpFriction:[void 0,1]},void 0,{snapDistanceX:[.1],snapDistanceY:[.1],snapCooldown:[0]},{timeTrapTime:[0],timeTrapMaxTime:[0]},void 0,void 0,void 0,void 0,void 0,void 0,void 0,{maxPushDistance:[0]},void 0,void 0,void 0,void 0],A.A.effectMapI2N=["bound","kill","bounce","custom","customImage","stopForces","winpad","coin","coindoor","checkpoint","breakable","safe","tp","conveyor","platformer","restrictAxis","snapGrid","timeTrap","changeSize","changeSpeed","solidColor","invisible","changeMap","tornado","changeVignette","pushable","changeMusic","changeShip","changeGrapple","changeDeathTimer"],A.A.effectDefaultMap=[{},{boundPlayer:!1},{bounciness:1,decay:.98},{},{url:"http://tinyurl.com/dwayne-t-rj"},{},{},{coinAmount:1,color:"#d6d611"},{coindoorCoinAmount:3,coinDoorColor:"#d6d611"},{checkpointOffsetX:0,checkpointOffsetY:0},{maxStrength:60,regenTime:100,healSpeed:1},{},{tpx:100,tpy:100},{conveyorForce:.3,conveyorAngle:90,conveyorAngleRotateSpeed:0,conveyorFriction:.8},{platformerForce:1,platformerAngle:90,platformerAngleRotateSpeed:0,platformerFriction:.875,maxJumpCooldown:30,jumpForce:20,jumpDecay:.95},{axisSpeedMultX:0,axisSpeedMultY:1},{toSnapX:!0,toSnapY:!0,snapDistanceX:100,snapDistanceY:100,snapCooldown:40,snapAngle:0,snapAngleRotateSpeed:0},{timeTrapMaxTime:300,timeTrapRecoverySpeed:1.5,timeTrapToKill:!0,timeTrapToShowTenth:!1},{sizeMult:1.5,sizeChangePermanent:!1},{speedMult:2.5,speedChangePermanent:!1},{hex:"#FFFFFF",alpha:1},{},{mapName:"hub",toCustomPlanet:!1},{tornadoStrength:1},{innerR:0,innerG:0,innerB:0,innerSize:.1,innerOpacity:0,outerR:0,outerG:0,outerB:0,outerSize:.5,outerOpacity:1},{pushAngle:180,maxPushDistance:100,idlePushBackSpeed:.25,positiveDirectionOnly:!1,pushConversionRatio:.8},{musicPath:"https://www.youtube.com/watch?v=OidXKRVVV70",musicStartTime:0},{changeShipStateTo:!0,initialShipAngle:0,shipTurnSpeed:Math.PI/100},{changeGrappleStateTo:!0,grappleRange:488,grappleForce:.01,grappleFric:.4},{changeDeathTimerStateTo:!0,drainAmountWhileStandingOn:0,deathTime:10}];const gt=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,(e,t)=>{if(0===e.conveyorAngleRotateSpeed)return!1;t.conveyorAngle=e.conveyorAngle},(e,t)=>{if(0===e.platformerAngleRotateSpeed)return!1;t.platformerAngle=e.platformerAngle},void 0,(e,t)=>{if(0===e.snapAngleRotateSpeed)return!1;t.snapAngle=e.snapAngle},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],mt=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,e=>{!1!==Number.isFinite(e.conveyorAngle)&&(e.conveyorAngle=conveyorAngle)},e=>{!1!==Number.isFinite(e.platformerAngle)&&(e.platformerAngle=platformerAngle)},void 0,e=>{!1!==Number.isFinite(e.snapAngle)&&(e.snapAngle=snapAngle)},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0];A.A.generateSyncMaps=()=>{if(void 0===A.A.simulateToSync){A.A.simulateToSync=new Map,A.A.idleEffectToSync=new Map;for(let e=0;e<st.length;e++)void 0!==ct[e]&&A.A.simulateToSync.set(st[e],ct[e]);for(let e=0;e<ft.length;e++)void 0!==gt[e]&&A.A.idleEffectToSync.set(ft[e],gt[e])}},A.A.generateApplySyncMaps=()=>{if(void 0===A.A.simulateToApplySync){A.A.simulateToApplySync=new Map,A.A.idleEffectToApplySync=new Map;for(let e=0;e<st.length;e++)void 0!==pt[e]&&A.A.simulateToApplySync.set(st[e],pt[e]);for(let e=0;e<ft.length;e++)void 0!==mt[e]&&A.A.idleEffectToApplySync.set(ft[e],mt[e])}};const xt=[e=>{ctx.fillStyle=A.A.colors.tile},e=>{ctx.fillStyle=!0===e.boundPlayer?"#c70000":"#9e0000",ctx.strokeStyle="black",ctx.toStroke=!0,ctx.lineWidth=4},e=>{ctx.fillStyle="blue"},e=>{ctx.toFill=!1,ctx.cleanUpFunction=()=>{ctx.save(),ctx.clip(),ctx.drawImage(A.A.starImg,e.topLeft.x,e.topLeft.y,e.dimensions.x,e.dimensions.y),ctx.restore()}},e=>{ctx.toFill=!1,!1!==e.imgLoaded&&(ctx.cleanUpFunction=()=>{ctx.save(),ctx.clip(),ctx.drawImage(e.img,e.topLeft.x,e.topLeft.y,e.dimensions.x,e.dimensions.y),ctx.restore()})},e=>{ctx.fillStyle="orange",ctx.strokeStyle="black",ctx.lineWidth=6,ctx.globalAlpha=.1,ctx.toStroke=!0},e=>{ctx.fillStyle=`hsl(${1e3*window.frames/60/12},50%,50%)`,ctx.shadowColor=ctx.fillStyle,ctx.shadowBlur=15,ctx.cleanUpFunction=()=>{ctx.shadowBlur=0}},e=>{ctx.fillStyle=e.color,!0===e.collected?ctx.globalAlpha=.2:ctx.globalAlpha=.8,1!==e.coinAmount&&(ctx.cleanUpFunction=()=>{let t=e.topLeft.x+e.dimensions.x/2,n=e.topLeft.y+e.dimensions.y/2;ctx.fillStyle=A.A.colors.tile,ctx.font=`${Math.min(60,e.dimensions.x/4,e.dimensions.y/4)}px Inter`,ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText(Math.max(0,e.coinAmount),t,n)})},e=>{ctx.fillStyle=A.A.colors.tile,ctx.globalAlpha=e.coins<=0?.5:1,ctx.cleanUpFunction=()=>{ctx.fillStyle=e.coinDoorColor;let t=e.topLeft.x+e.dimensions.x/2,n=e.topLeft.y+e.dimensions.y/2;ctx.beginPath(),ctx.roundRect(t-e.dimensions.x/4,n-e.dimensions.y/4,e.dimensions.x/2,e.dimensions.y/2,Math.min(e.dimensions.x,e.dimensions.y)/20),ctx.fill(),ctx.closePath(),ctx.fillStyle=A.A.colors.tile,ctx.font=`${Math.min(60,e.dimensions.x/4,e.dimensions.y/4)}px Inter`,ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText(Math.max(0,e.coins),t,n)}},e=>{!0===e.checkpointCollected?(ctx.fillStyle="#0fba09",ctx.globalAlpha=.15):(ctx.fillStyle="#05962b",ctx.globalAlpha=.8)},e=>{ctx.fillStyle=A.A.colors.tile,ctx.fillStyle=Ye("#000000",ctx.fillStyle,.5),ctx.globalAlpha=e.strength/e.maxStrength},e=>{ctx.fillStyle="rgba(140,140,140,.25)",ctx.strokeStyle="black",ctx.lineWidth=4,ctx.toStroke=!0},e=>{ctx.fillStyle="#38ab30"},e=>{ctx.fillStyle=A.A.colors.tile,ctx.globalAlpha=.1,ctx.cleanUpFunction=()=>{ctx.save(),ctx.clip(),ctx.globalAlpha=1;for(let t=e.topLeft.x+50;t<=e.topLeft.x+e.dimensions.x+50;t+=100)for(let n=e.topLeft.y+50;n<=e.topLeft.y+e.dimensions.y+50;n+=100)ctx.translate(t,n),ctx.rotate(e.conveyorAngle+Math.PI/2),ctx.drawImage(A.A.arrowImg,-50,-50,100,100),ctx.rotate(-e.conveyorAngle-Math.PI/2),ctx.translate(-t,-n);ctx.restore()}},e=>{ctx.fillStyle=A.A.colors.tile,ctx.globalAlpha=.1,ctx.cleanUpFunction=()=>{ctx.save(),ctx.clip();const t=1e3*window.frames/60*e.platformerForce*Math.cos(e.platformerAngle)/10%100-100,n=1e3*window.frames/60*e.platformerForce*Math.sin(e.platformerAngle)/10%100-100;ctx.globalAlpha=1;for(let o=e.topLeft.x+t+50;o<=e.topLeft.x+e.dimensions.x+50;o+=100)for(let t=e.topLeft.y+n+50;t<=e.topLeft.y+e.dimensions.y+50;t+=100)ctx.translate(o,t),ctx.rotate(e.platformerAngle+Math.PI/2),ctx.drawImage(A.A.arrowImg,-50,-50,100,100),ctx.rotate(-e.platformerAngle-Math.PI/2),ctx.translate(-o,-t);if(ctx.restore(),!0===e.canJump&&!0===e.touchingPlatformer){const e=A.A.players[A.A.selfId];void 0!==e&&(ctx.globalAlpha=1,ctx.fillStyle="white",ctx.font="56px Inter",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("👍",e.pos.x,e.pos.y-e.sat.r-50))}e.touchingPlatformer=!1}},e=>{e.axisSpeedMultX<0&&e.axisSpeedMultY<0?ctx.strokeStyle="red":e.axisSpeedMultX<0||e.axisSpeedMultY<0?ctx.strokeStyle="#ff6969":e.axisSpeedMultY>1||e.axisSpeedMultY>1?ctx.strokeStyle="#c5c500":ctx.strokeStyle="white",ctx.lineWidth=4,ctx.toFill=!1,ctx.toStroke=!0,ctx.cleanUpFunction=()=>{ctx.lineWidth=3,ctx.save(),ctx.translate(e.topLeft.x+e.dimensions.x/2,e.topLeft.y+e.dimensions.y/2),ctx.clip(),ctx.globalAlpha=e.axisSpeedMultX>1?.8:Math.max(.3,e.axisSpeedMultX<0?-e.axisSpeedMultX:1-e.axisSpeedMultX),ctx.strokeStyle=e.axisSpeedMultX<0?"red":e.axisSpeedMultX>1?"#c5c500":"white",ctx.beginPath();for(let t=-e.dimensions.x/2;t<=e.dimensions.x/2;t+=100)ctx.moveTo(t,-e.dimensions.y/2),ctx.lineTo(t,e.dimensions.y/2);ctx.stroke(),ctx.closePath(),ctx.globalAlpha=e.axisSpeedMultY>1?.8:Math.max(.3,e.axisSpeedMultY<0?-e.axisSpeedMultY:1-e.axisSpeedMultY),ctx.strokeStyle=e.axisSpeedMultY<0?"red":e.axisSpeedMultY>1?"#c5c500":"white",ctx.beginPath();for(let t=-e.dimensions.y/2;t<=e.dimensions.y/2;t+=100)ctx.moveTo(-e.dimensions.x/2,t),ctx.lineTo(e.dimensions.x/2,t);ctx.stroke(),ctx.closePath(),ctx.restore()}},e=>{ctx.fillStyle="#00008a",ctx.globalAlpha=.1,ctx.toClip=!0,ctx.cleanUpFunction=()=>{ctx.save(),ctx.clip(),ctx.strokeStyle=Ye("#0f0000","#000000",Math.max(0,e.snapCooldown)/e.maxSnapCooldown),ctx.lineWidth=4,ctx.globalAlpha=.17;let t=e.topLeft.x+e.dimensions.x/2,n=e.topLeft.y+e.dimensions.y/2;ctx.translate(t,n),e.snapRotateMovementExpansion={base:Math.max(e.dimensions.x,e.dimensions.y)**2/Math.sqrt(e.dimensions.x**2+e.dimensions.y**2)},e.snapRotateMovementExpansion.x=Math.ceil(e.snapRotateMovementExpansion.base/e.snapDistanceX+1)*e.snapDistanceX,e.snapRotateMovementExpansion.y=Math.ceil(e.snapRotateMovementExpansion.base/e.snapDistanceY+1)*e.snapDistanceY,ctx.rotate(e.snapAngle);let o=new Path2D;if(!0===e.toSnapX)for(let t=-e.snapRotateMovementExpansion.x;t<=e.snapRotateMovementExpansion.x;t+=e.snapDistanceX)o.rect(-10+t,-e.snapRotateMovementExpansion.x-10,20,2*e.snapRotateMovementExpansion.x+20);if(!0===e.toSnapY)for(let t=-e.snapRotateMovementExpansion.y;t<=e.snapRotateMovementExpansion.y;t+=e.snapDistanceY)o.rect(-e.snapRotateMovementExpansion.y-10,-10+t,2*e.snapRotateMovementExpansion.y+20,20);ctx.stroke(o),ctx.closePath();const i=A.A.players[A.A.selfId];i.pos.x+e.snapMagnitude<t-e.dimensions.x/2||i.pos.x-e.snapMagnitude>t+e.dimensions.x/2||i.pos.y+e.snapMagnitude<n-e.dimensions.y/2||i.pos.y-e.snapMagnitude>n+e.dimensions.y/2||(ctx.strokeStyle="grey",ctx.fillStyle="black",ctx.globalAlpha=.2,ctx.beginPath(),ctx.clip(o),ctx.rotate(-e.snapAngle),ctx.translate(-t,-n),ctx.arc(i.pos.x,i.pos.y,e.snapMagnitude,0,2*Math.PI),ctx.stroke(),ctx.fill(),ctx.closePath()),ctx.restore()}},e=>{let t=e.topLeft.x+e.dimensions.x/2,n=e.topLeft.y+e.dimensions.y/2,o=ctx.createRadialGradient(t,n,0,t,n,Math.min(100,(e.dimensions.x+e.dimensions.y)/3));!1===e.timeTrapToKill?(o.addColorStop(0,"rgba(199,199,199,0)"),o.addColorStop(1,"rgba(199,199,199,1)")):(o.addColorStop(0,"rgba(199,0,0,0)"),o.addColorStop(1,"rgba(199,0,0,1)")),ctx.fillStyle=o,ctx.globalAlpha=Math.max(.12,.5-e.timeTrapTime/e.timeTrapMaxTime/2),ctx.cleanUpFunction=()=>{ctx.globalAlpha=Math.max(.3,e.timeTrapTime/e.timeTrapMaxTime/3),ctx.fillStyle="white",ctx.font=Math.min(e.dimensions.x,e.dimensions.y)/2+"px Inter",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText(!0===e.timeTrapToShowTenth?Math.round(e.timeTrapTime/60*10)/10:Math.round(e.timeTrapTime/60),t,n)}},e=>{!0===e.sizeChangePermanent&&(ctx.toStroke=!0,ctx.lineWidth=10,ctx.lineDashOffset=1e3*-window.frames/60/15,e.sizeMult>1?ctx.strokeStyle="#0e30ad":ctx.strokeStyle="#1c1852",ctx.setLineDash([30,40]),ctx.cleanUpFunction=()=>{ctx.setLineDash([])}),!0===e.permanentSizeChangeDone?ctx.toFill=!1:e.sizeMult>1?ctx.fillStyle="#0e30ad":ctx.fillStyle="#1c1852",ctx.globalAlpha=.28},e=>{!0===e.speedChangePermanent&&(ctx.toStroke=!0,ctx.lineWidth=10,ctx.lineDashOffset=1e3*-window.frames/60/15,ctx.strokeStyle="#eba500",ctx.setLineDash([30,40]),ctx.cleanUpFunction=()=>{ctx.setLineDash([])}),!0===e.permanentSpeedChangeDone?ctx.toFill=!1:(ctx.fillStyle="#eba500",ctx.toStroke=!0,ctx.lineWidth=3,ctx.strokeStyle=ctx.fillStyle),ctx.globalAlpha=.25},e=>{ctx.fillStyle=e.hex,!0===e.isText?ctx.globalAlpha=0:ctx.globalAlpha=e.alpha},e=>{},e=>{if(!0===e.toCustomPlanet)return ctx.fillStyle="#646464",void(ctx.cleanUpFunction=()=>{ctx.font=`1000 ${Math.min(e.dimensions.x,e.dimensions.y)/2}px Inter`,ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillStyle="#464646",ctx.translate(e.topLeft.x+e.dimensions.x/2,e.topLeft.y+e.dimensions.y/2),void 0===e.randomSineOffset&&(e.randomSineOffset=Math.random()*Math.PI*2);const t=.32*Math.sin(window.frames/36+e.randomSineOffset);ctx.rotate(t),ctx.fillText("?",0,0),ctx.rotate(-t),ctx.translate(-(e.topLeft.x+e.dimensions.x/2),-(e.topLeft.y+e.dimensions.y/2)),ctx.fillStyle="white",ctx.font=e.dimensions.x/3.5+"px Inter",ctx.textAlign="center",ctx.textBaseline="middle",ctx.globalAlpha=Math.min(1,(A.A.players[A.A.selfId].pos.y+canvas.h/2-e.topLeft.y)/e.dimensions.y),ctx.globalAlpha*=.8,ctx.fillText(e.mapName,e.topLeft.x+e.dimensions.x/2,e.topLeft.y-e.dimensions.y/4),ctx.globalAlpha=1});let t=(1+Math.sin(window.frames/36))/2*(e.difficulty%1);ctx.fillStyle=Ye(yt[Math.floor(e.difficulty)],yt[Math.min(8,Math.ceil(e.difficulty))],t),ctx.cleanUpFunction=()=>{if(e.dimensions.x>e.dimensions.y?ctx.translate(e.dimensions.x-e.dimensions.y+e.topLeft.x,e.topLeft.y):ctx.translate(e.topLeft.x,e.dimensions.y-e.dimensions.x+e.topLeft.y),ctx.lineCap="round",ctx.globalAlpha=t,At[Math.min(8,Math.ceil(e.difficulty))](Math.min(e.dimensions.x,e.dimensions.y)),ctx.globalAlpha=1-t,At[Math.floor(e.difficulty)](Math.min(e.dimensions.x,e.dimensions.y)),ctx.lineCap="square",ctx.globalAlpha=1,e.dimensions.x>e.dimensions.y?ctx.translate(-(e.dimensions.x-e.dimensions.y+e.topLeft.x),-e.topLeft.y):ctx.translate(-e.topLeft.x,-(e.dimensions.y-e.dimensions.x+e.topLeft.y)),ctx.font=e.dimensions.x/3.5+"px Inter",!0===A.A.mapsBeaten["/maps/"+e.mapName]){const n=Ye(yt[Math.floor(e.difficulty)],yt[Math.ceil(e.difficulty)],t);ctx.fillStyle=A.A.blendColor(n,"#000000",.12)}else ctx.fillStyle="white";ctx.textAlign="center",ctx.textBaseline="middle",ctx.globalAlpha=Math.min(1,(A.A.players[A.A.selfId].pos.y+canvas.h/2-e.topLeft.y)/e.dimensions.y),ctx.fillText(e.mapName.toUpperCase().replace("O","o"),e.topLeft.x+e.dimensions.x/2,e.topLeft.y-e.dimensions.y/4),ctx.globalAlpha=1}},e=>{ctx.fillStyle="#c0bbc9",ctx.globalAlpha=.25},e=>{ctx.toFill=!1},e=>{ctx.fillStyle=A.A.colors.tile,ctx.cleanUpFunction=()=>{ctx.save(),ctx.clip(),ctx.strokeStyle="white",ctx.lineWidth=3,ctx.globalAlpha=.25,ctx.beginPath(),e.topLeft=ot(e),ctx.lineTo(e.topLeft.x,e.topLeft.y),ctx.lineTo(e.topLeft.x+e.dimensions.x,e.topLeft.y+e.dimensions.y),ctx.stroke(),ctx.beginPath(),ctx.lineTo(e.topLeft.x+e.dimensions.x,e.topLeft.y),ctx.lineTo(e.topLeft.x,e.topLeft.y+e.dimensions.y),ctx.stroke(),ctx.globalAlpha=1,ctx.lineWidth=3,ctx.restore()}},e=>{ctx.toFill=!1},e=>{ctx.fillStyle=!0===e.changeShipStateTo?"rgba(0,0,255,0.3)":"rgba(255,255,0,0.3)",ctx.strokeStyle=!0===e.changeShipStateTo?"blue":"yellow",ctx.lineDashOffset=1e3*-window.frames/60*150/1e3,ctx.lineWidth=4,ctx.setLineDash([30,30]),ctx.toStroke=!0,ctx.cleanUpFunction=()=>{ctx.setLineDash([])}},e=>{let t,n=e.topLeft.x+e.dimensions.x/2,o=e.topLeft.y+e.dimensions.y/2,i=ctx.createRadialGradient(n,o,0,n,o,Math.sqrt(e.dimensions.x**2+e.dimensions.y**2)/2);!0===e.changeGrappleStateTo?(t=1e3*window.frames/60/1600%.33,i.addColorStop(1,"rgba(127,127,255,0)"),i.addColorStop(.67+t,"rgba(127,127,255,1)"),i.addColorStop(.66+t,"rgba(127,127,255,0)"),i.addColorStop(.34+t,"rgba(127,127,255,1)"),i.addColorStop(.33+t,"rgba(127,127,255,0)"),i.addColorStop(.0101+t,"rgba(127,127,255,1)"),.01+t>0&&i.addColorStop(.01+t,"rgba(127,127,255,0)"),i.addColorStop(0,"rgba(127,127,255,1)")):(t=.33-1e3*window.frames/60/1600%.33,i.addColorStop(1,"rgba(255,255,127,0)"),i.addColorStop(.67+t,"rgba(255,255,127,1)"),i.addColorStop(.66+t,"rgba(255,255,127,0)"),i.addColorStop(.34+t,"rgba(255,255,127,1)"),i.addColorStop(.33+t,"rgba(255,255,127,0)"),i.addColorStop(.0101+t,"rgba(255,255,127,1)"),.01+t>0&&i.addColorStop(.01+t,"rgba(255,255,127,0)"),i.addColorStop(0,"rgba(255,255,127,1)")),ctx.fillStyle=i},e=>{if(void 0===A.A.skullImg)return A.A.skullImg=new Image,A.A.skullImg.src="https://svgsilh.com/svg/1294357.svg",void(A.A.skullImg.onload=()=>{A.A.skullImgLoaded=!0});ctx.fillStyle=!0===e.changeDeathTimerStateTo?"red":"white",ctx.globalAlpha=.4,!1!==A.A.skullImgLoaded&&(ctx.cleanUpFunction=()=>{ctx.globalAlpha=1;let t=e.topLeft.x+e.dimensions.x/2,n=e.topLeft.y+e.dimensions.y/2,o=Math.min(e.dimensions.x,e.dimensions.y);ctx.drawImage(A.A.skullImg,t-o/2,n-o/2,o,o)})}],yt=A.A.difficultyImageColors=["#6cd95b","#58ccb3","#0a77bf","#3528e0","#a142c9","#e32d8b","#fc5434","#fc3a3a","#c95d5d"],At=A.A.difficultyImageMap=[e=>{ctx.globalAlpha*=.3,ctx.strokeStyle="black",ctx.lineWidth=3*e/40,ctx.beginPath(),ctx.arc(e/2,e/2,e/4,0,2*Math.PI),ctx.stroke(),ctx.closePath()},e=>{ctx.strokeStyle="#288a75",ctx.lineWidth=3*e/40,ctx.beginPath(),ctx.arc(5*e/12,5*e/12,e/4,0,2*Math.PI),ctx.stroke(),ctx.closePath(),ctx.beginPath(),ctx.arc(7*e/12,7*e/12,e/4,0,2*Math.PI),ctx.stroke(),ctx.closePath()},e=>{ctx.globalAlpha*=.3,ctx.strokeStyle="black",ctx.lineWidth=3*e/40,ctx.strokeRect(e/4,e/4,e/2,e/2)},e=>{ctx.globalAlpha*=.3,ctx.strokeStyle="black",ctx.lineWidth=3*e/40,ctx.strokeRect(e/6,e/6,5*e/12,5*e/12),ctx.strokeRect(5*e/12,5*e/12,5*e/12,5*e/12)},e=>{ctx.globalAlpha*=.3,ctx.strokeStyle="black",ctx.lineWidth=3*e/40,ctx.beginPath(),ctx.lineTo(5*e/24,12*e/24),ctx.lineTo(12*e/24,19*e/24),ctx.lineTo(19*e/24,12*e/24),ctx.lineTo(12*e/24,5*e/24),ctx.lineTo(5*e/24,12*e/24),ctx.stroke(),ctx.closePath()},e=>{ctx.strokeStyle="#991d5d",ctx.lineWidth=3*e/40,ctx.beginPath(),ctx.lineTo(1*e/6,3*e/6),ctx.lineTo(3*e/6,5*e/6),ctx.lineTo(5*e/6,3*e/6),ctx.lineTo(3*e/6,1*e/6),ctx.lineTo(1*e/6,3*e/6),ctx.stroke(),ctx.closePath(),ctx.strokeRect(5*e/24,5*e/24,14*e/24,14*e/24)},e=>{ctx.fillStyle="#d94a2e",ctx.fillRect(0,80*e/120,120*e/120,40*e/120),ctx.fillRect(40*e/120,60*e/120,40*e/120,20*e/120),ctx.beginPath(),ctx.lineTo(0,80*e/120),ctx.lineTo(20*e/120,40*e/120),ctx.lineTo(40*e/120,80*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(40*e/120,60*e/120),ctx.lineTo(60*e/120,20*e/120),ctx.lineTo(80*e/120,60*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(80*e/120,80*e/120),ctx.lineTo(100*e/120,40*e/120),ctx.lineTo(120*e/120,80*e/120),ctx.fill(),ctx.closePath()},e=>{ctx.fillStyle="#d63131",ctx.fillRect(40*e/120,0,40*e/120,20*e/120),ctx.fillRect(40*e/120,100*e/120,40*e/120,20*e/120),ctx.beginPath(),ctx.lineTo(0,120*e/120),ctx.lineTo(20*e/120,80*e/120),ctx.lineTo(40*e/120,120*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(40*e/120,100*e/120),ctx.lineTo(60*e/120,60*e/120),ctx.lineTo(80*e/120,100*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(80*e/120,120*e/120),ctx.lineTo(100*e/120,80*e/120),ctx.lineTo(120*e/120,120*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(0,0),ctx.lineTo(20*e/120,40*e/120),ctx.lineTo(40*e/120,0),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(40*e/120,20*e/120),ctx.lineTo(60*e/120,60*e/120),ctx.lineTo(80*e/120,20*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(80*e/120,0),ctx.lineTo(100*e/120,40*e/120),ctx.lineTo(120*e/120,0),ctx.fill(),ctx.closePath()},e=>{ctx.fillStyle="#8c4141",ctx.beginPath(),ctx.lineTo(0,0),ctx.lineTo(40*e/120,0),ctx.lineTo(0,40*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(40*e/120,0),ctx.lineTo(60*e/120,20*e/120),ctx.lineTo(80*e/120,0),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(120*e/120,0),ctx.lineTo(80*e/120,0),ctx.lineTo(120*e/120,40*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(120*e/120,40*e/120),ctx.lineTo(100*e/120,60*e/120),ctx.lineTo(120*e/120,80*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(120*e/120,120*e/120),ctx.lineTo(80*e/120,120*e/120),ctx.lineTo(120*e/120,80*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(40*e/120,120*e/120),ctx.lineTo(60*e/120,100*e/120),ctx.lineTo(80*e/120,120*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(0,120*e/120),ctx.lineTo(40*e/120,120*e/120),ctx.lineTo(0,80*e/120),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineTo(0,80*e/120),ctx.lineTo(20*e/120,60*e/120),ctx.lineTo(0,40*e/120),ctx.fill(),ctx.closePath()}],vt=A.A.obstacles=[];A.A.spawnPosition={x:100,y:100},A.A.createPlayer=()=>{We(0,[],[],{x:A.A.spawnPosition.x,y:A.A.spawnPosition.y,r:49.5});const e=vt.pop();return e.axisSpeedMultX=e.axisSpeedMultY=1,e.touchingNormalIndexes=[],e.lastTouchingNormalIndexes=[],e.renderRadius=e.lastAliveRadius=e.sat.r,e.xv=e.yv=e.xa=e.ya=0,e.interpX=e.interpY=0,e.speed=e.baseSpeed=7.167,e.dead=!1,e.onSafe=!1,e.touchingWall=!1,e.stopForces=!1,e.forces=[],e.id=void 0,e.dev=!A.A.isProd,e.god=!1,e.friction=.4,e.ship=!1,e.shipAngle=0,e.shipTurnSpeed=Math.PI/100,e.deathTime=0,e.deathTimer=!1,e.grappleX=-1,e.grappleY=-1,e.grapple=!1,e.grappleRange=488,e.grappleForce=.01,e.grappleFric=.414,e.timeTrapOverrideSafe=!1,e},A.A.players=[],!0===A.A.isExClient&&!0!==A.A.isEditor||(A.A.players.push(A.A.createPlayer()),A.A.selfId=0,A.A.mapDimensions={x:2e3,y:2e3}),!0!==A.A.isExClient&&"server"!==Xe||(A.A.mapDimensions={x:2e3,y:2e3});const St=function(){const e=A.A.players[A.A.selfId];if(!0===A.A.isExClient&&!1===e.dead?(!0===A.A.touchMode?(e.xa=Math.cos(A.A.touchAngle)*e.speed,e.ya=Math.sin(A.A.touchAngle)*e.speed):(e.xa=(A.A.input.right-A.A.input.left)*e.speed,e.ya=(A.A.input.down-A.A.input.up)*e.speed),!0===A.A.input.shift&&(!0===e.god?(e.xa*=5,e.ya*=5):(e.xa*=.5,e.ya*=.5)),!1===e.ship?(e.xv+=e.xa*e.axisSpeedMultX,e.yv+=e.ya*e.axisSpeedMultY):(e.shipAngle+=e.xa*e.shipTurnSpeed,e.xv-=Math.cos(e.shipAngle)*e.ya*e.axisSpeedMultX,e.yv-=Math.sin(e.shipAngle)*e.ya*e.axisSpeedMultY),e.pos.x+=e.xv,e.pos.y+=e.yv,e.xv*=e.friction,e.yv*=e.friction):!0===A.A.dragging&&!1===e.dead?(Ge=0===e.axisSpeedMultX||0===e.axisSpeedMultY?Math.atan2(A.A.mouseY-e.pos.y,A.A.mouseX-e.pos.x):Math.atan2((A.A.mouseY-e.pos.y)*e.axisSpeedMultX,(A.A.mouseX-e.pos.x)*e.axisSpeedMultY),e.xv=Math.cos(Ge)*e.speed*e.axisSpeedMultX,e.yv=Math.sin(Ge)*e.speed*e.axisSpeedMultY,Math.abs(e.xv)>Math.abs(e.pos.x-A.A.mouseX)&&(e.xv=A.A.mouseX-e.pos.x),Math.abs(e.yv)>Math.abs(e.pos.y-A.A.mouseY)&&(e.yv=A.A.mouseY-e.pos.y),e.pos.x+=e.xv,e.pos.y+=e.yv):e.xv=e.yv=0,e.axisSpeedMultX=e.axisSpeedMultY=1,!0===e.stopForces)e.stopForces=!1,e.forces.length=0;else for(let t=0;t<e.forces.length;t+=3)e.pos.x+=e.forces[t],e.pos.y+=e.forces[t+1],e.forces[t]*=e.forces[t+2],e.forces[t+1]*=e.forces[t+2],Math.abs(e.forces[t])<.01&&Math.abs(e.forces[t+1])<.01&&(e.forces.splice(t,3),t-=3);if(!0===e.dead){e.forces.length=0,e.renderRadius=e.lastAliveRadius;for(let t=0;t<vt.length;t++)for(let n=0;n<vt[t].simulate.length;n++)vt[t].simulate[n](vt[t],e)}else{if(e.lastAliveRadius=e.sat.r,!0!==e.god){e.pos.x-e.sat.r<0?e.pos.x=e.sat.r:e.pos.x+e.sat.r>A.A.mapDimensions.x&&(e.pos.x=A.A.mapDimensions.x-e.sat.r),e.pos.y-e.sat.r<0?e.pos.y=e.sat.r:e.pos.y+e.sat.r>A.A.mapDimensions.y&&(e.pos.y=A.A.mapDimensions.y-e.sat.r);for(let t=0;t<vt.length;t++){if(Je=void 0!==vt[t].sat.r?void 0!==vt[t].startSlice?Ze(vt[t],e,qe):_e.testCircleCircle(vt[t].sat,e.sat,qe):_e.testPolygonCircle(vt[t].sat,e.sat,qe),!0===Je)for(let n=0;n<vt[t].effect.length;n++)vt[t].effect[n](e,qe,vt[t],t);qe.clear();for(let n=0;n<vt[t].simulate.length;n++)vt[t].simulate[n](vt[t],e)}}else for(let t=0;t<vt.length;t++)for(let n=0;n<vt[t].simulate.length;n++)vt[t].simulate[n](vt[t],e);if(!0===e.grapple)if(!0===A.A.input.action1&&-1===e.grappleX){let t=e.sat.r;e.sat.r=e.grappleRange;let n=0,o=0,i=!1;for(let t=0;t<vt.length;t++)!0===vt[t].isGrapplePoint&&!1===i&&(o=e.sat.r,e.sat.r=e.grappleRange),Je=void 0!==vt[t].sat.r?void 0!==vt[t].startSlice?Ze(vt[t],e,qe):_e.testCircleCircle(vt[t].sat,e.sat,qe):_e.testPolygonCircle(vt[t].sat,e.sat,qe),!0===vt[t].isGrapplePoint?!0===Je?(i=!0,e.sat.r-=qe.overlap,n=Math.atan2(qe.overlapN.y,qe.overlapN.x)):!1===i&&(e.sat.r=o):!0===Je&&!1===i&&(e.sat.r-=qe.overlap,n=Math.atan2(qe.overlapN.y,qe.overlapN.x)),qe.clear();e.sat.r<e.grappleRange&&(e.sat.r=Math.max(e.sat.r,0),e.grappleX=e.pos.x-Math.cos(n)*e.sat.r,e.grappleY=e.pos.y-Math.sin(n)*e.sat.r),e.sat.r=t}else if(-1!==e.grappleX)if(!1===A.A.input.action1)e.grappleX=e.grappleY=-1;else{let t=Math.sqrt((e.pos.x-e.grappleX)**2+(e.pos.y-e.grappleY)**2),n=Math.atan2(e.grappleY-e.pos.y,e.grappleX-e.pos.x);e.forces.push(Math.cos(n)*t*e.grappleForce,Math.sin(n)*t*e.grappleForce,e.grappleFric)}const t=A.A.colors.vignette;for(let e in t.innerInterp)t.innerInterp[e]=$e(t.innerInterp[e],t.inner[e],.03);for(let e in t.outerInterp)t.outerInterp[e]=$e(t.outerInterp[e],t.outer[e],.03)}for(let e=0;e<A.A.players.length;e++){const t=A.A.players[e];void 0!==t&&((t.interpX-t.pos.x)**2+(t.interpY-t.pos.y)**2>123904&&(t.interpX=t.pos.x,t.interpY=t.pos.y),t.interpX=$e(t.interpX,t.pos.x,.4),t.interpY=$e(t.interpY,t.pos.y,.4),t.renderRadius=$e(t.renderRadius,t.sat.r,1/5.4))}if(0===e.touchingNormalIndexes.length&&0===e.lastTouchingNormalIndexes.length||(e.lastTouchingNormalIndexes=e.touchingNormalIndexes,e.touchingNormalIndexes=[]),!0===e.onSafe&&(e.onSafe=!1,!0===e.timeTrapOverrideSafe?e.timeTrapOverrideSafe=!1:e.dead=!1),!0===e.deathTimer&&(e.deathTime--,(e.deathTime<0||!0===e.dead)&&(e.deathTime=1/0,e.deathTimer=!1,e.dead=!0,A.A.u4[0]=14,A.A.send(A.A.u4))),e.touchingWall=!1,e.sat.r>900&&(e.sat.r=900),!0!==e.god?(e.pos.x-e.sat.r<0?(e.pos.x=e.sat.r,e.touchingWall=!0):e.pos.x+e.sat.r>A.A.mapDimensions.x&&(e.pos.x=A.A.mapDimensions.x-e.sat.r,e.touchingWall=!0),e.pos.y-e.sat.r<0?(e.pos.y=e.sat.r,e.touchingWall=!0):e.pos.y+e.sat.r>A.A.mapDimensions.y&&(e.pos.y=A.A.mapDimensions.y-e.sat.r,e.touchingWall=!0)):e.dead=!1,A.A.tickFns.length>0){for(let e=0;e<A.A.tickFns.length;e++)A.A.tickFns[e]();A.A.tickFns.length=0}!0===je&&(je=!1,!0===A.A.dragging&&window.onmouseup(),Ne()),window.frames++};A.A.mouse={screen:{x:-1,y:-1},world:{x:-1,y:-1}},A.A.mouseX=-1,A.A.mouseY=-1,A.A.scrollLocked=!1,A.A.mouseDownFunctions=[],A.A.mouseMoveFunctions=[],A.A.mouseUpFunctions=[],A.A.mouseOut=!1,A.A.pageX=-1,A.A.pageY=-1,A.A.dragging=!1,window.onmousedown=e=>{},window.onmousemove=e=>{},window.onmouseup=()=>{},window.oncontextmenu=e=>e.preventDefault();const wt={KeyW:"up",KeyS:"down",KeyA:"left",KeyD:"right",ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right",ShiftLeft:"shift",ShiftRight:"shift",KeyC:"action1",KeyJ:"action1",KeyY:"action1"};A.A.input={up:!1,down:!1,left:!1,right:!1,shift:!1,action1:!1};let bt=!1,Mt=!1;window.onkeydown=Rt,window.onkeyup=Rt;const{encodeAtPosition:Tt}=le,Pt=document.querySelector(".chat"),kt=document.querySelector(".chatDiv"),It=document.querySelector(".chat-div"),Ct=document.querySelector(".leaderboard-div");function Rt(e){if(!0===bt){if("keydown"===e.type&&"Enter"===e.code){let e=Pt.value.trim();if("/reset"===e)A.A.changeMap("/maps/hub");else if("/help"===e)A.A.addChatMessage(": Evades X is a futuristic dodging game where anything is possible!<br><br>Commands:<br>/reset - teleports you to the hub world<br>...and that's it lol, more commands coming soon","system");else if(!1===A.A.isProd&&"/tpmap"===e.slice(0,6))A.A.changeMap("/maps/"+e.slice(7).toLowerCase());else if(!1===A.A.isProd&&"/scale"===e.slice(0,6)){const t=parseFloat(e.slice(7));A.A.changeCameraScale(t)}else if(!1===A.A.isProd&&"/map"===e.slice(0,4))A.A.initImportMap(e.slice(5));else if("/mute"!==e.slice(0,5)||"trit"!==A.A.username&&"Serum0017"!==A.A.username)if("/ban"!==e.slice(0,4)||"trit"!==A.A.username&&"Serum0017"!==A.A.username){if(0!==e.length){e=A.A.username+": "+e;const t=new Uint8Array(e.length+2);t[0]=7,!0===A.A.players[A.A.selfId].dev?t[1]=2:!0===A.A.players[A.A.selfId].guest&&(t[1]=3),Tt(e,t,2),A.A.send(t)}}else{const t=e.slice(5),n=new Uint8Array(t.length+1);n[0]=6,Tt(t,n,1),A.A.send(n)}else{const t=e.slice(6),n=new Uint8Array(t.length+1);n[0]=5,Tt(t,n,1),A.A.send(n)}Pt.value="",Pt.blur(),kt.classList.add("hidden"),bt=!1}}else{if(e.repeat)return e.preventDefault();if("keydown"===e.type){if("KeyO"===e.code&&!1===A.A.isProd&&!0===A.A.players[A.A.selfId].dev){A.A.players[A.A.selfId].god=!A.A.players[A.A.selfId].god;const t=new Uint8Array(2);return t[0]=8,t[1]=A.A.players[A.A.selfId].god,A.A.send(t),e.preventDefault()}"KeyR"===e.code&&!0===A.A.players[A.A.selfId].dead?A.A.respawnPlayer():"Enter"===e.code?(bt=!0,kt.classList.remove("hidden"),Pt.focus()):"KeyZ"===e.code&&!0!==A.A.isEditor?(Mt?(It.classList.contains("hideChat")&&(It.classList.remove("hideChat"),It.scrollTop=It.scrollHeight),Ct.classList.contains("hideLB")&&Ct.classList.remove("hideLB")):(Pt.blur(),It.classList.contains("hideChat")||It.classList.add("hideChat"),Ct.classList.contains("hideLB")||Ct.classList.add("hideLB")),Mt=!Mt):"KeyT"===e.code&&!0!==A.A.isEditor?A.A.toggleTimer():"KeyU"===e.code&&!1===A.A.isProd&&(A.A.renderDebug=!A.A.renderDebug)}null!=wt[e.code]&&(A.A.input[wt[e.code]]="keydown"===e.type,e.preventDefault())}}let Lt;A.A.initImportMap=async e=>{void 0===Lt&&(Lt=(await i.e(78).then(i.bind(i,78))).default),Lt(e)},A.A.touchMode=!1,A.A.touchAngle=-1,window.ontouchstart=()=>{A.A.touchMode=!0},window.ontouchmove=e=>{const t=e.changedTouches[0];void 0!==t&&(t.pageX<window.innerWidth/2?(A.A.input.left=!0,A.A.input.right=!1):(A.A.input.left=!1,A.A.input.right=!0),t.pageY<window.innerHeight/2?(A.A.input.up=!0,A.A.input.down=!1):(A.A.input.up=!1,A.A.input.down=!0),A.A.touchAngle=Math.atan2(t.pageY-window.innerHeight/2,t.pageX-window.innerWidth/2))},window.ontouchend=()=>{A.A.touchMode=!1};const{until:Ft}=le;let Et,Dt;A.A.hasLoadedNewMusic=!1;let Bt=0;A.A.stopMusic=async(e=!1)=>{if(!0===e){let e=!1,t=Date.now();if(await Ft((()=>void 0!==Dt&&(Bt>t&&(e=!0),!0))),!0===e)return}else if(void 0===Dt)return;Dt.remove(),Dt=void 0,Et=void 0},A.A.playMusic=async(e,t=0)=>{if(A.A.hasLoadedNewMusic=!0,await Ft((()=>!0===navigator.userActivation.hasBeenActive)),e===Et)return;A.A.stopMusic(),Et=e,Dt=document.createElement("iframe"),Dt.frameborder="0",Dt.setAttribute("frameBorder","0"),Dt.width=0,Dt.height=0;const n=e.split("?v=")[1];Dt.src=`https://www.youtube.com/embed/${n}?autoplay=1&loop=1&playlist=${n}&enablejsapi=1${0===t?"":"&start="+t}`,Dt.allow="autoplay",Dt.security="restricted",Dt.style.position="fixed",Dt.classList.add("yt"),Dt.id=n,document.body.appendChild(Dt),Bt=Date.now()},A.A.playMusicIndefinitely=async e=>{Et=void 0,await A.A.playMusic(e),Dt=void 0},A.A.reloadMusic=()=>{let e=Et;Et=void 0,A.A.playMusic(e)},A.A.mapDifficulties=Object.freeze({winroom:0,hub:0,pom:0,popb:.25,poca:1.01,pospd:2.8,pos:3.01,pols:5.01,povv:2.3,poqt:5.33,podc:6.01,posc:.55,poph:4.33,powc:1.85,posh:1.39}),A.A.mapLeaderboardNames=Object.freeze({winroom:"Winroom",hub:"Hub",pom:"Planet of 🗺️",popb:"Planet of Peaceful Beginnings",poca:"Planet of Conveyor Abuse",pospd:"Planet of Speed (nyoom)",pos:"Planet of Safezones",pols:"Planet of Lost Sanity",povv:"Planet of The Vibing Vault",poqt:"Planet of Quick Thinking",podc:"Planet of Difficulty Chart",posc:"Planet of Simple Challenges",poph:"Planet of Prehistory",posh:`Planet of ${Math.random()<.01?"Suspicious":"Slight"} Hurdles`,powc:"Planet of Wacky Craze"}),A.A.isExClient=!0;const zt=A.A.gui=document.querySelector(".gui");A.A.mapPath="",A.A.username="",A.A.authId=-1,A.A.startGame=()=>{!1===A.A.isEditor&&zt.classList.remove("hidden"),Ut=performance.now(),A.A.respawnPlayer(),Nt(),console.log("game starting")};let Ut=0,Ot=0;function Nt(){if(requestAnimationFrame(Nt),Ot=performance.now(),A.A.accum+=Ot-Ut,Ut=Ot,A.A.accum>2e3)if(A.A.players.length<=1)A.A.accum=0;else{A.A.accum=-1/0,A.A.offtabSync=!0;const e=new Uint8Array(1);e[0]=16,A.A.send(e)}for(;A.A.accum>=0;)A.A.accum-=A.A.FRAME_TIME,St();!function(){const e=A.A.players[A.A.selfId];(Math.abs(e.pos.x-_t)>.1||Math.abs(e.pos.y-Wt)>.1)&&(Xt[0]=4,Yt[1]=e.pos.x,Yt[2]=e.pos.y,A.A.send(Xt)),!0===e.grapple&&(Xt[0]=11,Yt[1]=e.grappleX,Yt[2]=e.grappleY,A.A.send(Xt),Xt[0]=4),!0===e.ship&&Gt!==e.shipAngle&&(Gt=e.shipAngle,Vt[0]=9,jt[1]=e.shipAngle,A.A.send(Vt)),!0===e.deathTimer&&(Vt[0]=13,jt[1]=e.deathTime,A.A.send(Vt)),e.dead!==qt&&(qt=e.dead,A.A.u4[0]=15,A.A.u4[1]=!0===e.dead?1:0,A.A.send(A.A.u4)),e.sat.r!==$t&&($t=e.sat.r,Vt[0]=22,jt[1]=e.sat.r,A.A.send(Vt))}(),A.A.render()}window.frames=0,A.A.accum=0,A.A.FRAME_TIME=1e3/60,A.A.offtabSync=!1;const Xt=new Uint8Array(12),Yt=new Float32Array(Xt.buffer),Vt=new Uint8Array(8),jt=new Float32Array(Vt.buffer);A.A.u4=new Uint8Array(4);let _t=1/0,Wt=1/0,$t=1/0,Gt=1/0,qt=!1})();